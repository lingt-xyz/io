(window.webpackJsonp=window.webpackJsonp||[]).push([[99],{235:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return s})),n.d(t,"metadata",(function(){return o})),n.d(t,"rightToc",(function(){return i})),n.d(t,"default",(function(){return l}));var r=n(2),a=n(9),c=(n(0),n(261)),s={title:"Sequence to Sequence"},o={id:"research/Seq2Seq",isDocsHomePage:!1,title:"Sequence to Sequence",description:"What is sequence-to-sequence learning?",source:"@site/docs/research/Seq2Seq.md",permalink:"/docs/research/Seq2Seq",editUrl:"https://github.com/lingt-xyz/io/tree/master/docs/research/Seq2Seq.md",lastUpdatedAt:1596145966,sidebar:"research",previous:{title:"MathJax & KaTex",permalink:"/docs/research/MathTax"},next:{title:"Keras Log",permalink:"/docs/research/KerasLog"}},i=[{value:"References",id:"references",children:[]},{value:"Codes",id:"codes",children:[]}],u={rightToc:i};function l(e){var t=e.components,n=Object(a.a)(e,["components"]);return Object(c.b)("wrapper",Object(r.a)({},u,n,{components:t,mdxType:"MDXLayout"}),Object(c.b)("blockquote",null,Object(c.b)("p",{parentName:"blockquote"},"What is sequence-to-sequence learning?")),Object(c.b)("p",null,"Sequence-to-sequence learning (Seq2Seq) is about training models to convert sequences from one domain (e.g. sentences in English) to sequences in another domain (e.g. the same sentences translated to French)."),Object(c.b)("h4",{id:"the-trivial-case-when-input-and-output-sequences-have-the-same-length"},"The trivial case when input and output sequences have the same length"),Object(c.b)("p",null,"When both input sequences and output sequences have the same length, you can implement such models simply with a Keras LSTM or GRU layer (or stack thereof)."),Object(c.b)("p",null,"One caveat of this approach is that it assumes that it is possible to generate target","[...t]"," given input","[...t]",". That works in some cases (e.g. adding strings of digits) but does not work for most use cases. In the general case, information about the entire input sequence is necessary in order to start generating the target sequence. Here's how it works:"),Object(c.b)("ul",null,Object(c.b)("li",{parentName:"ul"},'A RNN layer (or stack thereof) acts as "encoder": it processes the input sequence and returns its own internal state. Note that we discard the outputs of the encoder RNN, only recovering the state. This state will serve as the "context", or "conditioning", of the decoder in the next step.'),Object(c.b)("li",{parentName:"ul"},'Another RNN layer (or stack thereof) acts as "decoder": it is trained to predict the next characters of the target sequence, given previous characters of the target sequence. Specifically, it is trained to turn the target sequences into the same sequences but offset by one timestep in the future, a training process called "teacher forcing" in this context. Importantly, the encoder uses as initial state the state vectors from the encoder, which is how the decoder obtains information about what it is supposed to generate. Effectively, the decoder learns to generate targets',"[t+1...]"," given targets","[...t]",", conditioned on the input sequence.")),Object(c.b)("p",null,"In inference mode, i.e. when we want to decode unknown input sequences, we go through a slightly different process:"),Object(c.b)("p",null,"1) Encode the input sequence into state vectors.\n2) Start with a target sequence of size 1 (just the start-of-sequence character).\n3) Feed the state vectors and 1-char target sequence to the decoder to produce predictions for the next character.\n4) Sample the next character using these predictions (we simply use argmax).\n5) Append the sampled character to the target sequence\n6) Repeat until we generate the end-of-sequence character or we hit the character limit."),Object(c.b)("h4",{id:"the-general-case-canonical-sequence-to-sequence"},"The general case: canonical sequence-to-sequence"),Object(c.b)("p",null,"In the general case, input sequences and output sequences have different lengths (e.g. machine translation) and the entire input sequence is required in order to start predicting the target."),Object(c.b)("h2",{id:"references"},"References"),Object(c.b)("ul",null,Object(c.b)("li",{parentName:"ul"},Object(c.b)("a",Object(r.a)({parentName:"li"},{href:"https://blog.keras.io/a-ten-minute-introduction-to-sequence-to-sequence-learning-in-keras.html"}),"A ten-minute introduction to sequence-to-sequence learning in Keras")),Object(c.b)("li",{parentName:"ul"},Object(c.b)("a",Object(r.a)({parentName:"li"},{href:"https://keras.io/examples/nlp/lstm_seq2seq/"}),"Character-level recurrent sequence-to-sequence model")),Object(c.b)("li",{parentName:"ul"},Object(c.b)("a",Object(r.a)({parentName:"li"},{href:"https://medium.com/@dev.elect.iitd/neural-machine-translation-using-word-level-seq2seq-model-47538cba8cd7"}),"Neural Machine Translation using word level seq2seq model"))),Object(c.b)("h2",{id:"codes"},"Codes"),Object(c.b)("ul",null,Object(c.b)("li",{parentName:"ul"},Object(c.b)("a",Object(r.a)({parentName:"li"},{href:"https://github.com/keras-team/keras/blob/master/examples/lstm_seq2seq.py"}),"lstm_seq2seq"))))}l.isMDXComponent=!0},261:function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return b}));var r=n(0),a=n.n(r);function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},c=Object.keys(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var u=a.a.createContext({}),l=function(e){var t=a.a.useContext(u),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},h=function(e){var t=l(e.components);return a.a.createElement(u.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.a.createElement(a.a.Fragment,{},t)}},d=a.a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,c=e.originalType,s=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),h=l(n),d=r,b=h["".concat(s,".").concat(d)]||h[d]||p[d]||c;return n?a.a.createElement(b,o(o({ref:t},u),{},{components:n})):a.a.createElement(b,o({ref:t},u))}));function b(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var c=n.length,s=new Array(c);s[0]=d;var o={};for(var i in t)hasOwnProperty.call(t,i)&&(o[i]=t[i]);o.originalType=e,o.mdxType="string"==typeof e?e:r,s[1]=o;for(var u=2;u<c;u++)s[u]=n[u];return a.a.createElement.apply(null,s)}return a.a.createElement.apply(null,n)}d.displayName="MDXCreateElement"}}]);