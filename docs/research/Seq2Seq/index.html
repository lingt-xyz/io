<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.58">
<link rel="search" type="application/opensearchdescription+xml" title="密云不雨" href="/opensearch.xml">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous"><title data-react-helmet="true">Sequence to Sequence | 密云不雨</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Sequence to Sequence | 密云不雨"><meta data-react-helmet="true" name="description" content="What is sequence-to-sequence learning?"><meta data-react-helmet="true" property="og:description" content="What is sequence-to-sequence learning?"><meta data-react-helmet="true" property="og:url" content="https://lingt.xyz//docs/research/Seq2Seq"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://lingt.xyz//docs/research/Seq2Seq"><link rel="stylesheet" href="/styles.af2b8c94.css">
<link rel="preload" href="/styles.7d64bcba.js" as="script">
<link rel="preload" href="/runtime~main.51476d32.js" as="script">
<link rel="preload" href="/main.5fecef52.js" as="script">
<link rel="preload" href="/1.c015ecf3.js" as="script">
<link rel="preload" href="/2.d01dcd03.js" as="script">
<link rel="preload" href="/3.6a5c2864.js" as="script">
<link rel="preload" href="/1be78505.5b4489fb.js" as="script">
<link rel="preload" href="/137.4e125233.js" as="script">
<link rel="preload" href="/20ac7829.8ca134be.js" as="script">
<link rel="preload" href="/17896441.e85942b2.js" as="script">
<link rel="preload" href="/ce369163.3b59bf69.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=window.matchMedia("(prefers-color-scheme: dark)"),n=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==n?t(n):e.matches&&t("dark")}()</script><div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/logo.svg" alt="Logo"><strong class="navbar__title">Ling</strong></a><a class="navbar__item navbar__link" href="/docs/course/INSE6110">Course</a><a class="navbar__item navbar__link" href="/docs/TA/COMP352">TA</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/research/MathTax">Research</a><div class="navbar__item dropdown dropdown--hoverable dropdown--left"><a activeclassname="navbar__link--active" class="navbar__item navbar__link">Programming</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/programming/container/Container">Container</a></li><li><a class="dropdown__link" href="/docs/programming/Go/1Why">Go</a></li><li><a class="dropdown__link" href="/docs/programming/Python/Python">Python</a></li><li><a class="dropdown__link" href="/docs/programming/JavaScript/JavaScript">JavaScript</a></li><li><a class="dropdown__link" href="/docs/programming/Java/1IDE">Java</a></li><li><a class="dropdown__link" href="/docs/programming/C++/C++">C++</a></li><li><a class="dropdown__link" href="/docs/programming/database/Cassandra_in_Docker">Database</a></li></ul></div><a class="navbar__item navbar__link" href="/docs/linux/Bash">Linux</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/lingt-xyz/lingt-xyz.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_1gtM"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_keGJ moon_1gwN"></span></div><div class="react-toggle-track-x"><span class="toggle_keGJ sun_3CPA"></span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><div class="navbar__search"><div class="searchWrapper_-F3-"><span aria-label="expand searchbar" role="button" class="searchIconButton_1Dnz" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Search" aria-label="Search" class="navbar__search-input searchInput_2eto"></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/logo.svg" alt="Logo"><strong class="navbar__title">Ling</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/course/INSE6110">Course</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/TA/COMP352">TA</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/research/MathTax">Research</a></li><li class="menu__list-item"><a activeclassname="navbar__link--active" class="menu__link menu__link--sublist">Programming</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/programming/container/Container">Container</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/programming/Go/1Why">Go</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/programming/Python/Python">Python</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/programming/JavaScript/JavaScript">JavaScript</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/programming/Java/1IDE">Java</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/programming/C++/C++">C++</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/programming/database/Cassandra_in_Docker">Database</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/docs/linux/Bash">Linux</a></li><li class="menu__list-item"><a class="menu__link" href="/blog">Blog</a></li><li class="menu__list-item"><a href="https://github.com/lingt-xyz/lingt-xyz.github.io" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_1kjD"><div class="docSidebarContainer_1cYp" role="complementary"><div class="sidebar_1kLs"><div class="menu menu--responsive menu_w2sC"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_2vk4" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/research/Common_Commands">Common Commands</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/research/Dictionary">Dictionary</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/research/MathTax">MathJax &amp; KaTex</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" href="/docs/research/Seq2Seq">Sequence to Sequence</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/research/KerasLog">Keras Log</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/research/TFLog">TensorFlow Log</a></li></ul></div></div></div><main class="docMainContainer_FFX1"><div class="container padding-vert--lg docItemWrapper_1cc7"><div class="row"><div class="col docItemCol_2GOA"><div class="docItemContainer_2cwg"><article><header><h1 class="docTitle_1vWb">Sequence to Sequence</h1></header><div class="markdown"><blockquote><p>What is sequence-to-sequence learning?</p></blockquote><p>Sequence-to-sequence learning (Seq2Seq) is about training models to convert sequences from one domain (e.g. sentences in English) to sequences in another domain (e.g. the same sentences translated to French).</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="the-trivial-case-when-input-and-output-sequences-have-the-same-length"></a>The trivial case when input and output sequences have the same length<a aria-hidden="true" tabindex="-1" class="hash-link" href="#the-trivial-case-when-input-and-output-sequences-have-the-same-length" title="Direct link to heading">#</a></h4><p>When both input sequences and output sequences have the same length, you can implement such models simply with a Keras LSTM or GRU layer (or stack thereof).</p><p>One caveat of this approach is that it assumes that it is possible to generate target[...t] given input[...t]. That works in some cases (e.g. adding strings of digits) but does not work for most use cases. In the general case, information about the entire input sequence is necessary in order to start generating the target sequence. Here&#x27;s how it works:</p><ul><li>A RNN layer (or stack thereof) acts as &quot;encoder&quot;: it processes the input sequence and returns its own internal state. Note that we discard the outputs of the encoder RNN, only recovering the state. This state will serve as the &quot;context&quot;, or &quot;conditioning&quot;, of the decoder in the next step.</li><li>Another RNN layer (or stack thereof) acts as &quot;decoder&quot;: it is trained to predict the next characters of the target sequence, given previous characters of the target sequence. Specifically, it is trained to turn the target sequences into the same sequences but offset by one timestep in the future, a training process called &quot;teacher forcing&quot; in this context. Importantly, the encoder uses as initial state the state vectors from the encoder, which is how the decoder obtains information about what it is supposed to generate. Effectively, the decoder learns to generate targets[t+1...] given targets[...t], conditioned on the input sequence.</li></ul><p>In inference mode, i.e. when we want to decode unknown input sequences, we go through a slightly different process:</p><p>1) Encode the input sequence into state vectors.
2) Start with a target sequence of size 1 (just the start-of-sequence character).
3) Feed the state vectors and 1-char target sequence to the decoder to produce predictions for the next character.
4) Sample the next character using these predictions (we simply use argmax).
5) Append the sampled character to the target sequence
6) Repeat until we generate the end-of-sequence character or we hit the character limit.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="the-general-case-canonical-sequence-to-sequence"></a>The general case: canonical sequence-to-sequence<a aria-hidden="true" tabindex="-1" class="hash-link" href="#the-general-case-canonical-sequence-to-sequence" title="Direct link to heading">#</a></h4><p>In the general case, input sequences and output sequences have different lengths (e.g. machine translation) and the entire input sequence is required in order to start predicting the target.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="references"></a>References<a aria-hidden="true" tabindex="-1" class="hash-link" href="#references" title="Direct link to heading">#</a></h2><ul><li><a href="https://blog.keras.io/a-ten-minute-introduction-to-sequence-to-sequence-learning-in-keras.html">A ten-minute introduction to sequence-to-sequence learning in Keras</a></li><li><a href="https://keras.io/examples/nlp/lstm_seq2seq/" target="_blank" rel="noopener noreferrer">Character-level recurrent sequence-to-sequence model</a></li><li><a href="https://medium.com/@dev.elect.iitd/neural-machine-translation-using-word-level-seq2seq-model-47538cba8cd7" target="_blank" rel="noopener noreferrer">Neural Machine Translation using word level seq2seq model</a></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="codes"></a>Codes<a aria-hidden="true" tabindex="-1" class="hash-link" href="#codes" title="Direct link to heading">#</a></h2><ul><li><a href="https://github.com/keras-team/keras/blob/master/examples/lstm_seq2seq.py">lstm_seq2seq</a></li></ul></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/lingt-xyz/io/tree/master/docs/research/Seq2Seq.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col text--right"><em><small>Last updated on <time datetime="2020-07-30T21:52:46.000Z" class="docLastUpdatedAt_1sqk">7/30/2020</time></small></em></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/research/MathTax"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« MathJax &amp; KaTex</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/research/KerasLog"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Keras Log »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_TbNY"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#references" class="table-of-contents__link">References</a></li><li><a href="#codes" class="table-of-contents__link">Codes</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="text--center"><div>Copyright © 2021 Ling. Built with Docusaurus.</div></div></div></footer></div>
<script src="/styles.7d64bcba.js"></script>
<script src="/runtime~main.51476d32.js"></script>
<script src="/main.5fecef52.js"></script>
<script src="/1.c015ecf3.js"></script>
<script src="/2.d01dcd03.js"></script>
<script src="/3.6a5c2864.js"></script>
<script src="/1be78505.5b4489fb.js"></script>
<script src="/137.4e125233.js"></script>
<script src="/20ac7829.8ca134be.js"></script>
<script src="/17896441.e85942b2.js"></script>
<script src="/ce369163.3b59bf69.js"></script>
</body>
</html>