<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.58">
<title data-react-helmet="true">SOEN 321 | Ling</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="SOEN 321 | Ling"><meta data-react-helmet="true" name="description" content="SOEN 321 Winter 2019"><meta data-react-helmet="true" property="og:description" content="SOEN 321 Winter 2019"><meta data-react-helmet="true" property="og:url" content="https://lingt.xyz//docs/course/SOEN321"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://lingt.xyz//docs/course/SOEN321"><link rel="stylesheet" href="/styles.e6e8e8cd.css">
<link rel="preload" href="/styles.5110f610.js" as="script">
<link rel="preload" href="/runtime~main.411159be.js" as="script">
<link rel="preload" href="/main.5092485a.js" as="script">
<link rel="preload" href="/1.342f0786.js" as="script">
<link rel="preload" href="/2.e69fd93d.js" as="script">
<link rel="preload" href="/3.31f2c4b8.js" as="script">
<link rel="preload" href="/1be78505.636d6477.js" as="script">
<link rel="preload" href="/47.c1ae8faa.js" as="script">
<link rel="preload" href="/20ac7829.3d0e1285.js" as="script">
<link rel="preload" href="/17896441.78a6df2d.js" as="script">
<link rel="preload" href="/a3e49c46.d2ab06bb.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=window.matchMedia("(prefers-color-scheme: dark)"),n=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==n?t(n):e.matches&&t("dark")}()</script><div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/logo.svg" alt="Logo"><strong class="navbar__title">Ling</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/course/doc1">Course</a><a class="navbar__item navbar__link" href="/docs/linux/bash">Linux</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/lingt-xyz/lingt-xyz.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_1gtM"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_keGJ moon_1gwN"></span></div><div class="react-toggle-track-x"><span class="toggle_keGJ sun_3CPA"></span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/logo.svg" alt="Logo"><strong class="navbar__title">Ling</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/course/doc1">Course</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/linux/bash">Linux</a></li><li class="menu__list-item"><a class="menu__link" href="/blog">Blog</a></li><li class="menu__list-item"><a href="https://github.com/lingt-xyz/lingt-xyz.github.io" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_1kjD"><div class="docSidebarContainer_1cYp" role="complementary"><div class="sidebar_1kLs"><div class="menu menu--responsive menu_w2sC"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_2vk4" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">INSE</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/course/doc1">Style Guide</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/course/doc2">Document Number 2</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/course/doc3">This is Document Number 3</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">SOEN</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/course/SOEN321">SOEN 321</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/course/SOEN321_Project">SOEN 321 Project</a></li></ul></li></ul></div></div></div><main class="docMainContainer_FFX1"><div class="container padding-vert--lg docItemWrapper_1cc7"><div class="row"><div class="col docItemCol_2GOA"><div class="docItemContainer_2cwg"><article><header><h1 class="docTitle_1vWb">SOEN 321</h1></header><div class="markdown"><p>SOEN 321 Winter 2019</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="outline"></a>Outline<a aria-hidden="true" tabindex="-1" class="hash-link" href="#outline" title="Direct link to heading">#</a></h2><ul><li>Instructor: <a href="https://users.encs.concordia.ca/~mmannan/" target="_blank" rel="noopener noreferrer">Dr. Mohammad Mannan</a></li><li><a href="https://moodle.concordia.ca/moodle/pluginfile.php/3413380/course/section/1071618/Winter2019-outline-SOEN321.pdf">Outline</a></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="final"></a>Final<a aria-hidden="true" tabindex="-1" class="hash-link" href="#final" title="Direct link to heading">#</a></h3><ul><li>Set 3: Stream cipher</li><li>Set 4: Block cipher</li><li>Set 5: Hash</li><li>Set 6: MAC</li><li>Set 7: PKI-SSL</li><li>Set 8: Usability</li><li>Set 9: Botnets-DDos</li><li>Set 14: Inuksuk</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="cheatsheet"></a>Cheatsheet<a aria-hidden="true" tabindex="-1" class="hash-link" href="#cheatsheet" title="Direct link to heading">#</a></h3><table><thead><tr><th>Name               </th><th align="left">Block size     </th><th align="left">Key size     </th><th align="left">Output size     </th><th align="left">Rounds     </th></tr></thead><tbody><tr><td>DES</td><td align="left">64</td><td align="left">56</td><td align="left"></td><td align="left">16</td></tr><tr><td>AES-128</td><td align="left">128</td><td align="left">128</td><td align="left"></td><td align="left">10</td></tr><tr><td>AES-192</td><td align="left">128</td><td align="left">192</td><td align="left"></td><td align="left">12</td></tr><tr><td>AES-256</td><td align="left">128</td><td align="left">256</td><td align="left"></td><td align="left">14</td></tr><tr><td>SHA1</td><td align="left"></td><td align="left"></td><td align="left">160</td><td align="left"></td></tr><tr><td>SHA2-256</td><td align="left"></td><td align="left"></td><td align="left">256</td><td align="left"></td></tr></tbody></table><hr><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="0-preparation"></a>0. Preparation<a aria-hidden="true" tabindex="-1" class="hash-link" href="#0-preparation" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="01-modulus"></a>0.1 Modulus<a aria-hidden="true" tabindex="-1" class="hash-link" href="#01-modulus" title="Direct link to heading">#</a></h3><p>$a\equiv b\pmod n$</p><ul><li>implies: $n$ divides $(a-b)$</li><li>implies: $a\pmod n = b\pmod n$</li><li>e.g.: $7\equiv 4\pmod 3$, $-11\equiv 17\pmod 7$</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="02-pseudo-random-number-generators-prng"></a>0.2 Pseudo-Random Number Generators (PRNG)<a aria-hidden="true" tabindex="-1" class="hash-link" href="#02-pseudo-random-number-generators-prng" title="Direct link to heading">#</a></h3><ul><li>Definition<ul><li>A given PRNG is a deterministic function that takes a fixed-length key (seed) and produces anunbounded bit stream.</li></ul></li><li>Same seed (entropy source), same sequence<ul><li>Hardware vs. Software sources</li><li>Sound/video input, disk drives</li><li>Elapsed time between emission of particles during radioactive decay</li><li>Linux (/dev/random)</li><li>Mouse, keyboard activities</li><li>Disk I/O</li><li>Interrupts</li><li>Embedded devices / IoTs</li><li>CPU support</li><li>Online service (should note be trusted)</li></ul></li><li>Produces “statistically random” numbers<ul><li>it passes standard tests for randomness</li></ul></li><li>Cryptographically secure, if<ul><li>Unpredictable (next-bit test): computationally infeasible to predict the next bit given a complete history of past bits.</li><li>Balanced: The number of $1$’s and $0$’s should be equal.</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="03-some-other-types-of-security"></a>0.3 Some Other Types of Security<a aria-hidden="true" tabindex="-1" class="hash-link" href="#03-some-other-types-of-security" title="Direct link to heading">#</a></h3><ul><li><p>Unconditional security:</p><ul><li>The uncertainty in the plaintext, after observing the ciphertext, must be equal to the a priori uncertainty about the plaintext. Observation of the ciphertext provides no information to an adversary.</li></ul></li><li><p>Computational security:</p><ul><li>level of computation required to defeat it (using best attack known) &gt;&gt; the computational resources of the adversary.</li><li>Data complexity is $2^n$: $n$ is the block size.</li><li>Processing complexity is $2^k$: $k$ is the key size.</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="04-attack-analysis"></a>0.4 Attack analysis<a aria-hidden="true" tabindex="-1" class="hash-link" href="#04-attack-analysis" title="Direct link to heading">#</a></h3><ul><li>Complexity of an attack<ol><li>Data complexity– expected number of required input data units (ciphertext blocks).<ul><li>For a block of size $n$, it is $2^n$.</li></ul></li><li>Storage complexity – expected number of required storage units..</li><li>Processing complexity – expected number of required operations on data.<ul><li>For a key of size $k$, it is $2^k$.</li></ul></li></ol></li><li>How to reduce complexity<ul><li>possible parallelization</li></ul></li></ul><hr><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="1-trusting-trust"></a>1. Trusting trust<a aria-hidden="true" tabindex="-1" class="hash-link" href="#1-trusting-trust" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="11-security-stack"></a>1.1 Security stack<a aria-hidden="true" tabindex="-1" class="hash-link" href="#11-security-stack" title="Direct link to heading">#</a></h3><p>![Security Stack]({{ site.baseurl }}/assets/resources/SOEN321/Security_Stack.png)</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="12-security-vs-correctness"></a>1.2 Security v.s. Correctness<a aria-hidden="true" tabindex="-1" class="hash-link" href="#12-security-vs-correctness" title="Direct link to heading">#</a></h3><ul><li>System security: System properties preserved in the face of an attack.</li><li>System correctness: For reasonable input, get reasonable output.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="13-what-code-to-trust"></a>1.3 What code to trust?<a aria-hidden="true" tabindex="-1" class="hash-link" href="#13-what-code-to-trust" title="Direct link to heading">#</a></h3><ol><li>Is Windows/OSX binary reliable?</li><li>No. So we use open-source, or wirte our own.</li><li>But we need to compile. </li><li>Who wrote the compiler?</li><li>So inspect the source code of the compiler, and recompiler the compiler.</li><li>But there is another compiler.<blockquote><p>&quot;The moral is obvious. You can&#x27;t trust code that you did not totally create yourself.&quot;</p></blockquote></li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="14-examples"></a>1.4 Examples<a aria-hidden="true" tabindex="-1" class="hash-link" href="#14-examples" title="Direct link to heading">#</a></h3><ul><li>The Bullrun project</li><li>The PRISM Program</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="15-security-mindset"></a>1.5 Security Mindset<a aria-hidden="true" tabindex="-1" class="hash-link" href="#15-security-mindset" title="Direct link to heading">#</a></h3><blockquote><p>“Think like an attacker, but do not attack.”</p></blockquote><hr><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="2-cryptography"></a>2. Cryptography<a aria-hidden="true" tabindex="-1" class="hash-link" href="#2-cryptography" title="Direct link to heading">#</a></h2><p>Cryptography $\neq$ Security</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="21-what-cryptography-is"></a>2.1 What Cryptography is<a aria-hidden="true" tabindex="-1" class="hash-link" href="#21-what-cryptography-is" title="Direct link to heading">#</a></h3><p>Cryptography is the study of <em>mathematical techniques</em> related to aspects of information security such as confidentiality, data integrity, entity authentication, and data origin authentication.</p><ul><li>Always think from three perspectives<ol><li>Defenders&#x27; view point</li><li>Attackers&#x27; view point</li><li>How much it will cost – to protect &amp; to attack</li></ol></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="22-what-cryptography-for"></a>2.2 What Cryptography for<a aria-hidden="true" tabindex="-1" class="hash-link" href="#22-what-cryptography-for" title="Direct link to heading">#</a></h3><ol><li><strong>Confidentiality</strong>: prevent others from reading a message</li><li><strong>Integrity</strong>: someone didn’t replace or modify a message</li><li>Data origin authentication: a message originated from a certain source</li><li>Entity authentication: a person is who he/she claims to be. e.g.: password</li><li>Non-repudiation: prevent someone from denying past commitments or actions; that is, someone cannot deny the validity of something.</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="23-cryptology"></a>2.3 Cryptology<a aria-hidden="true" tabindex="-1" class="hash-link" href="#23-cryptology" title="Direct link to heading">#</a></h3><ul><li>Cryptology = Cryptography + Cryptanalysis</li><li>Cryptanalysis: Study of code breaking</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="24-basic-tools-of-cryptography-security-primitives"></a>2.4 Basic tools of cryptography: Security Primitives<a aria-hidden="true" tabindex="-1" class="hash-link" href="#24-basic-tools-of-cryptography-security-primitives" title="Direct link to heading">#</a></h3><ol><li>Unkeyed Primitives<ul><li>Hash functions</li><li>One-way permutations</li><li>Random sequences</li></ul></li><li>Symmetric-key Primitives<ul><li>Symmetric-key ciphers<ul><li>Block ciphers</li><li>Stream ciphers</li></ul></li><li>Message Authentications Codes (MACs)</li><li>Signatures</li><li>Pseudorandom sequences</li><li>Identification primitives</li></ul></li><li>Public-key Primitives<ul><li>Public-key ciphers</li><li>Signatures</li><li>Identification primitives</li></ul></li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="25-attacker-model"></a>2.5 Attacker model<a aria-hidden="true" tabindex="-1" class="hash-link" href="#25-attacker-model" title="Direct link to heading">#</a></h3><ol><li>Passive vs. active attacker</li><li>What computational resources the attacker has?</li><li>What does the attacker know about a system?</li><li>What are the assumptions?<ul><li>encryption keys are shared via a secure channel</li></ul></li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="26-encryption"></a>2.6 Encryption<a aria-hidden="true" tabindex="-1" class="hash-link" href="#26-encryption" title="Direct link to heading">#</a></h3><p>![Encryption Model]({{ site.baseurl }}/assets/resources/SOEN321/Encryption_Model.png)</p><ul><li>Goals<ol><li>Data confidentiality</li><li>Protect a large amount of data with &quot;short&quot; secrets, like a lock-and-key.</li><li>Make it <em>difficult</em> for those without the secret key; efficient retrieval with the correct key.</li></ol></li><li>Simple model<ul><li>What to hide: key + plaintext</li></ul></li><li>Terminologies<ol><li>plaintext - the original message, denoted $m$ or $p$</li><li>ciphertext - the encoded message, denoted $c$</li><li><strong><em>cipher</em></strong> - algorithms for transforming plaintext to ciphertext and vice-versa</li><li>key - info used in cipher known only to sender/receiver</li><li>encipher (encrypt) - converting plaintext to ciphertext, denoted $E()$</li><li>decipher (decrypt) - recovering ciphertext from plaintext, denoted $D()$</li><li>substitution – each element is mapped into another</li><li>transposition – rearrangement of elements</li></ol></li><li>Kerckhoff’s Principle<ul><li>Security should depend only on the key<ul><li>Don’t assume enemy won’t know algorithm</li><li>Can capture machines, disassemble programs</li><li>Too expensive to invent new algorithm if it is compromised</li></ul></li><li>Security by obscurity does not work</li></ul></li><li>History<ul><li>Classical ciphers<ul><li>Pen &amp; paper, simple mechanical machines</li><li>Egyptians, Greeks, Romans, Hebrew scholars</li></ul></li><li>World War I<ul><li>Vernam Cipher (one time pad)</li></ul></li><li>World War II<ul><li>Complex electro-mechanical machines</li><li>Enigma</li></ul></li><li>Modern crypto<ul><li>Depends on – computers, math</li><li>Data Encryption Standard (DES) – 1975</li><li>Public key systems – 1976</li><li>Common people use</li></ul></li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="27-examples"></a>2.7 Examples<a aria-hidden="true" tabindex="-1" class="hash-link" href="#27-examples" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="1-substitution-ciphers"></a>1. Substitution ciphers<a aria-hidden="true" tabindex="-1" class="hash-link" href="#1-substitution-ciphers" title="Direct link to heading">#</a></h4><ul><li>How it works<ul><li>Each symbol in plaintext is replaced by another symbol according to some fixed permutation<ul><li>e.g.: Repalce $A$ by $D$, $B$ by $G$.</li></ul></li><li>For a set of English characters, all possible mappings is $26!$.</li><li>But such a large key space does not mean it is secure (why? Pattern).</li></ul></li><li>Substitution is said to add confusion (makes relationship between key and ciphertext as complex as possible)</li><li>Break it: Brute force key search<ul><li>English letter frequencies</li></ul></li></ul><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="shiftcaesar-cipher"></a>Shift/Caesar cipher<a aria-hidden="true" tabindex="-1" class="hash-link" href="#shiftcaesar-cipher" title="Direct link to heading">#</a></h5><ul><li>How it works<ul><li>It is one type of simple substitution cipher.</li><li>Shift each letter by an offset.</li><li>For a set of English characters, all possible mappings is $25$.</li></ul></li><li>Break it: Brute force<ul><li>Only $25$ keys</li></ul></li></ul><p>![Shift Cipher]({{ site.baseurl }}/assets/resources/SOEN321/Shift_Cipher.png)</p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="polyalphabetic-substitution"></a>Polyalphabetic substitution<a aria-hidden="true" tabindex="-1" class="hash-link" href="#polyalphabetic-substitution" title="Direct link to heading">#</a></h5><ul><li>How it works<ul><li>Multiple substitution alphabets<ul><li>Vigenère cipher</li><li>Enigma</li></ul></li><li>Pick a keyword, repeat it to mapping plaintext.</li><li>Lookup in the table using the keyword letter and its conresponding plaintext letter.</li></ul></li><li>Transposition is said to add diffusion (spreading out bits so redundancy in plaintext is spread over ciphertext), so more resistant to frequency analysis.</li><li><a href="http://pi.math.cornell.edu/~mec/2003-2004/cryptography/polyalpha/polyalpha.html">Break it</a></li></ul><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="transposition-cipher"></a>Transposition cipher<a aria-hidden="true" tabindex="-1" class="hash-link" href="#transposition-cipher" title="Direct link to heading">#</a></h5><ul><li>How it works<ul><li>With a fixed period $t$,</li><li>grouping the plaintext into blocks of $t$ characters,</li><li>applying to each block a single permutation $e$ on the numbers $1$ to $t$.</li></ul></li><li>e.g.: $t=6$<ul><li>$m=CAESAR$</li><li>$e=(6\ 4\ 1\ 3\ 5\ 2)$</li><li>$c=RSCEAA$</li><li>$d=(3\ 6\ 4\ 2\ 5\ 1)$</li></ul></li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="2-block--stream-ciphers"></a>2. Block &amp; stream ciphers<a aria-hidden="true" tabindex="-1" class="hash-link" href="#2-block--stream-ciphers" title="Direct link to heading">#</a></h4><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="block-cipher"></a>Block cipher<a aria-hidden="true" tabindex="-1" class="hash-link" href="#block-cipher" title="Direct link to heading">#</a></h5><ul><li>plaintext message is broken into fixed-length blocks before encryption</li><li>one block is processed at a time</li><li>most modern ciphers are block ciphers</li></ul><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="stream-cipher"></a>Stream cipher<a aria-hidden="true" tabindex="-1" class="hash-link" href="#stream-cipher" title="Direct link to heading">#</a></h5><ul><li>block length is one </li><li>requires only limited buffering of data</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="28-how-to-attack-encryption"></a>2.8 How to attack encryption<a aria-hidden="true" tabindex="-1" class="hash-link" href="#28-how-to-attack-encryption" title="Direct link to heading">#</a></h3><ol><li>Cryptanalysis<ul><li>Search for weaknesses in the algorithms</li><li>(Partial) knowledge about plaintext, ciphertext</li></ul></li><li>Brute-force<ul><li>Try all possible keys ($N$)</li><li>On average $N/2$ trails are required</li></ul></li><li>Malware, key/screenlogger, physical and side-channel attacks...</li></ol><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="attacks-on-encryption-schemes"></a>Attacks on encryption schemes<a aria-hidden="true" tabindex="-1" class="hash-link" href="#attacks-on-encryption-schemes" title="Direct link to heading">#</a></h4><ol><li>Ciphertext-only attack - deduce the decryption key or plaintext by only observing ciphertext</li><li>Known-plaintext attack - using a quantity of plaintext and corresponding ciphertext</li><li>Chosen-plaintext attack - choose plaintext and is then given corresponding ciphertext</li><li>Adaptive chosen-plaintext attack - chosen-plaintext attack where the choice of plaintext may depend on the ciphertext received from previous requests</li><li>Chosen-ciphertext attack - select the ciphertext, then the corresponding plaintext is given</li><li>Adaptive chosen-ciphertext attack - chosenciphertext attack where the choice of ciphertext may
depend on the plaintext received from previous requests</li></ol><hr><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="3-stream-ciphers"></a>3. Stream ciphers<a aria-hidden="true" tabindex="-1" class="hash-link" href="#3-stream-ciphers" title="Direct link to heading">#</a></h2><ul><li>Synchronous stream ciphers<ul><li>Key-stream is generated <em><strong>independently</strong></em> of plaintext and of ciphertext</li></ul></li><li>Self-synchronizing stream ciphers<ul><li>Key-stream is generated as a function of the key and a fixed number of <em><strong>previous</strong></em> ciphertext digits</li></ul></li><li>Examples:<ul><li>Vernam cipher</li><li>One-time pad</li><li>RC4</li><li>ChaCha20</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="31-vernam-cipher"></a>3.1 Vernam Cipher<a aria-hidden="true" tabindex="-1" class="hash-link" href="#31-vernam-cipher" title="Direct link to heading">#</a></h3><ul><li>How it works<ul><li>Plaintext: $m_1m_2\ldots m_t$</li><li>Key string: $k_1k_2\ldots k_t$</li><li>Cipertext: $c_1c_2\ldots c_t$</li><li>$c_i=m_i\oplus k_i, 1\leq i\leq t$</li></ul></li></ul><p>![Vernam Cipher]({{ site.baseurl }}/assets/resources/SOEN321/Vernam_Cipher.png)</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="32-one-time-pad"></a>3.2 One-time pad<a aria-hidden="true" tabindex="-1" class="hash-link" href="#32-one-time-pad" title="Direct link to heading">#</a></h3><ul><li><p>Why we need it</p><ul><li>Vernam cipher <em>&quot;can&quot;</em> use any bit source as a keystream, </li><li>But for real security the key should be <em><strong>random and never use again</strong></em>.</li><li>Vernam cipher with such a key-stream is called a one-time pad.</li><li>The one-time pad is provably secure.</li><li>One-time pad is unconditionally secure against a ciphertext-only attack, observation of the ciphertext provides no information to an adversary.</li></ul></li><li><p>How it works</p><ul><li>Same as vernam cipher</li></ul></li><li><p>What if</p><ul><li><p>Reuse the key-steam</p><ul><li><p>If ciphertexts and one plaintext are known.</p><p> $$
\begin{align<em>}
&amp;\text{Ciphertext}_1\oplus\text{Ciphertext}_2\
=\ &amp;\text{Plaintext}_1\oplus\text{key}\oplus\text{Plaintext}_2\oplus\text{key}\
=\ &amp;\text{Plaintext}_1\oplus\text{Plaintext}_2
\end{align</em>}
$$ </p></li></ul></li><li><p>Not random</p><ul><li>Brute-force</li></ul></li></ul></li><li><p>Probability of $0$ and $1$ in ciphertext</p><ul><li>In the plaintext, assume the probability $p(0)=x$, then $p(1)=1-x$.</li><li><em>Assume</em> the probability of a key bit $p(0)=p(1)=1/2$.</li><li>Four cases:</li></ul><ol><li>$p(m_i=0,k_i=0)=x\cdot 1/2=x/2$</li><li>$p(m_i=0,k_i=1)=x\cdot 1/2=x/2$</li><li>$p(m_i=1,k_i=0)=(1-x)\cdot 1/2=(1-x)/2$</li><li>$p(m_i=1,k_i=1)=(1-x)\cdot 1/2=(1-x)/2$</li></ol><ul><li>So:<ul><li>$p(c_i=0)=p(c_i=1)=x/2+(1-x)/2=1/2$</li></ul></li><li>But:<ul><li>No integrity</li></ul></li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="33-rc4"></a>3.3 RC4<a aria-hidden="true" tabindex="-1" class="hash-link" href="#33-rc4" title="Direct link to heading">#</a></h3><ul><li>What it is<ul><li>Byte-oriented, fast in software</li><li>Variable-length key: 40 – 2048 bits</li><li>Similar to the one-time pad except that generated pseudorandom bits, rather than a prepared stream, are used.</li></ul></li><li>How it works<ul><li>Initialization: the permutation $S$ is initialized with a variable length key.</li><li>Keystream: the stream of bits is generated using $S$ and two 8-bit index-pointers (denoted $i$ and $j$).</li><li>$\oplus$, same as one-time pad.</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="34-chacha20-stream-cipher"></a>3.4 ChaCha20 stream cipher<a aria-hidden="true" tabindex="-1" class="hash-link" href="#34-chacha20-stream-cipher" title="Direct link to heading">#</a></h3><ul><li>What it is<ul><li>256-bit key</li><li>96-bit nonce</li><li>32-bit block counter</li></ul></li><li>How it works<ul><li>Output a 64-byte block of key stream and increments block counter in each invocation<ul><li>$k=\text{ chacha_stream(key, nonce, counter)}$</li></ul></li><li>$c_i = m_i \oplus k_i$</li><li>If never use the same nonce with the same key twice, it is a one time pad.</li></ul></li></ul><hr><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="4-block-ciphers-symmetric-key"></a>4. Block ciphers (symmetric key)<a aria-hidden="true" tabindex="-1" class="hash-link" href="#4-block-ciphers-symmetric-key" title="Direct link to heading">#</a></h2><ul><li>What it is<ul><li>A function that maps $n$-bit plaintext blocks to $n$-bit (blocklength) ciphertext blocks.</li><li>If key $K$ is $k$ bits long, the number of keys is $2^k$.</li><li>Encryption: $C = E(M,K)$</li><li>Decryption: $M = D(C,K)$</li><li>The encryption function $E_k$ must be one-to-one (bijection).<ul><li>One-to-one: Because the encryption and decryption process must be reversed.</li><li>Not onto: Some $c_i$s have no correspoing $m_i$s, so if a bit flip occurs, decryption would fail.</li><li>Not one-to-one: Ambiguity, $c_i$ maps more than one $m_i$.</li></ul></li></ul></li></ul><p>![Bijection]({{ site.baseurl }}/assets/resources/SOEN321/Bijection.png)
![Non Bijection]({{ site.baseurl }}/assets/resources/SOEN321/Bijection_Non.png)</p><ul><li>Used for<ol><li>Data confidentiality</li><li>MACs</li><li>PRNGs (pseudorandom number generators)</li><li>Authentication</li></ol></li><li>Very efficient software and hardware implementations<ul><li>Can be used in low-resource devices</li></ul></li><li>Practical security<ul><li>Standard assumptions (in addition to Kerckhoff&#x27;s):<ul><li>attacker has access to all transmitted ciphertext.</li></ul></li><li>A block cipher is:<ul><li><strong><em>totally broken</em></strong> if key is recoverable, and</li><li><strong><em>partially broken</em></strong> if (some) plaintext is recoverable (without a key)</li></ul></li></ul></li><li>Modes of operation<ul><li>How to employ block ciphers for large messages<ol><li>Dividing messages</li><li>Padding the last block</li></ol></li><li>Basic modes<ul><li>ECB: Electronic Code Book</li><li>CBC: Cipher Block Chaining</li><li>OFB</li><li>CFB</li></ul></li><li>Initialization Vector (IV)<ul><li>A block of data used in addition to the input message</li><li>Randomize the encryption process</li></ul></li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="41-electronic-codebook-ecb"></a>4.1 Electronic Codebook (ECB)<a aria-hidden="true" tabindex="-1" class="hash-link" href="#41-electronic-codebook-ecb" title="Direct link to heading">#</a></h3><ul><li>Overview<ul><li>Same plaintext result in identical ciphertext</li><li>Blocks are enciphered independently of other blocks</li><li>Bit errors in a single ciphertext affect decipherment of that block <em><strong>only</strong></em></li></ul></li><li>How to<ul><li>$c_j=E_k(x_j)$</li><li>$x_j=E^{-1}(c_j)$</li></ul></li></ul><p>![ECB]({{ site.baseurl }}/assets/resources/SOEN321/ECB.png)</p><ul><li>Weakness<ul><li>Does not hide data patterns</li><li>Malicious substition of ciphertext is possible</li></ul></li></ul><p>![ECB_pattern]({{ site.baseurl }}/assets/resources/SOEN321/ECB_pattern.png)</p><ul><li>Usage<ul><li>When can we use this mode:<ul><li>Plaintext that has size of less than one block, to avoid pattern</li></ul></li><li>When not to use it:<ul><li>Multi-block messages</li><li>Key are reused more than a single block</li></ul></li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="42-cipher-block-chaining-cbc"></a>4.2 Cipher Block Chaining (CBC)<a aria-hidden="true" tabindex="-1" class="hash-link" href="#42-cipher-block-chaining-cbc" title="Direct link to heading">#</a></h3><ul><li><p>Overview</p><ul><li>Chaining causes ciphertext $c_j$ to depend on all preceding plaintext</li><li>Random access to encrypted data is not possible because of the previous reason.</li><li>Also because of that, only the <strong><em>same key, IV, plaintext</em></strong> results identical ciphertext.</li><li>IV must be <em><strong>integrity</strong></em>-proteced<ul><li>If not, attackers may make predictable bit changes to the 1st block.</li><li>If your salary is saved as $0111010$, you can flip the $0$ in IV corresponding to $0$ in your salary to change your salary to $1111111$.</li></ul></li><li>A single bit error in $c<em>j$ affects decryption of blocks $c_j, c</em>{j+1}$.</li></ul></li><li><p>How to</p><ul><li>$c<em>j=E_k(c</em>{j-1}\oplus x_j)$ for $j\geq 1$, $c_0=IV$</li><li>$x<em>j=c</em>{j-1}\oplus E^{-1}(c_j)$ for $j\geq 1$, $c_0=IV$</li></ul></li></ul><p>![CBC]({{ site.baseurl }}/assets/resources/SOEN321/CBC.png)</p><ul><li>Weakness<ul><li>Has known weaknesses?</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="43-counter-mode-ctr"></a>4.3 Counter mode (CTR)<a aria-hidden="true" tabindex="-1" class="hash-link" href="#43-counter-mode-ctr" title="Direct link to heading">#</a></h3><ul><li><p>Overview</p><ul><li>CTR must be different for each block</li><li><a href="https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation#Counter_(CTR)" target="_blank" rel="noopener noreferrer">An IV/nonce value is also used with the counter for uniqueness (concat/addition/xor) </a></li></ul></li><li><p>Advantage:</p><ol><li>Software and hardware efficiency: different blocks can be encrypted in parallel</li><li>Preprocessing: the encryption part can be done offline and when the message is known, just do the XOR.</li><li>Random access: decryption of a block can be done in random order, very useful for hard-disk encryption.</li></ol></li><li><p>How to</p></li></ul><p>![CTR]({{ site.baseurl }}/assets/resources/SOEN321/CTR.png)</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="44-xts-aes"></a>4.4 XTS-AES<a aria-hidden="true" tabindex="-1" class="hash-link" href="#44-xts-aes" title="Direct link to heading">#</a></h3><ul><li>XEX (xor-encrypt-xor): efficient processing of consecutive blocks within a data unit.</li><li>CTS (CipherText Stealing): provides support for sectors with size not divisible by block size.</li><li>XTS: XEX-based Tweaked CodeBook mode (TCB) with CipherText Stealing (CTS).</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="45-ecb-cts"></a>4.5 ECB-CTS<a aria-hidden="true" tabindex="-1" class="hash-link" href="#45-ecb-cts" title="Direct link to heading">#</a></h3><ul><li>How to</li></ul><p>![CTS]({{ site.baseurl }}/assets/resources/SOEN321/CTS.png)</p><ul><li>Why //TODO</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="46-block-cipher-design-components"></a>4.6 Block cipher: design components<a aria-hidden="true" tabindex="-1" class="hash-link" href="#46-block-cipher-design-components" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="avalanche-effect"></a>Avalanche effect<a aria-hidden="true" tabindex="-1" class="hash-link" href="#avalanche-effect" title="Direct link to heading">#</a></h4><ul><li>Slight change in input (e.g., flipping a single bit) significantly changes the output (e.g., half the output bits are flipped)</li><li>Strongly desired property of:<ul><li>Block ciphers</li><li>Cryptographic hash functions</li></ul></li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="product-cipher"></a>Product cipher<a aria-hidden="true" tabindex="-1" class="hash-link" href="#product-cipher" title="Direct link to heading">#</a></h4><ul><li>Execution of two or more simple ciphers in sequence (round of operations), such that the final product is cryptographically stronger than its components</li><li>In particular, alternating substitutions and transpositions</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="block-cipher-design-approaches"></a>Block cipher design approaches<a aria-hidden="true" tabindex="-1" class="hash-link" href="#block-cipher-design-approaches" title="Direct link to heading">#</a></h4><ul><li>A round function is used<ul><li>Strong avalanche effect</li><li>Bijective</li></ul></li><li>Repeated multiple times ($n$ rounds)<ul><li>Round $1$ input: plaintext block</li><li>Round $n$ output: ciphertext block</li><li>Round key: derived fromthe key $K$, for each round</li></ul></li><li>Examples<ul><li>SP networks (used in AES, CAST-128)</li><li>Feistel structures (used in DES, RC5, Blowfish)</li></ul></li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="substitution-permutation-sp-network"></a>Substitution-permutation (SP) network<a aria-hidden="true" tabindex="-1" class="hash-link" href="#substitution-permutation-sp-network" title="Direct link to heading">#</a></h4><ul><li>How to</li></ul><p>![SP]({{ site.baseurl }}/assets/resources/SOEN321/SP.png)
![SP Transposition]({{ site.baseurl }}/assets/resources/SOEN321/SP_T.png)</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="feistel-structure"></a>Feistel structure<a aria-hidden="true" tabindex="-1" class="hash-link" href="#feistel-structure" title="Direct link to heading">#</a></h4><ul><li><p>Overview</p><ol><li>Consists of a number of identical rounds of processing</li><li>In each round, a substitution is performed on 1/2 of plaintext block, followed by a permutation that interchanges two halves</li><li>The original key is expanded so a different key is used in each round</li><li>The Data Encryption Standard (DES) exhibits this structure</li></ol></li><li><p>How to</p><ul><li>$L<em>i = R</em>{i-1}$</li><li>$R<em>i=L</em>{i-1}\oplus f(R_{i-1},K_i)$</li></ul></li></ul><p>![Feistel Structure]({{ site.baseurl }}/assets/resources/SOEN321/Feistel_Structure.png)</p><ul><li>Feistel structure parameters<ul><li>Block size &amp; key size:<ul><li>larger means greater security, but may slow down encryption/decryption speed</li></ul></li><li>Number of rounds:<ul><li>more rounds means greater strength</li><li>typically 16 rounds</li></ul></li><li>Subkey generation algorithm &amp; round function:<ul><li>greater complexity should lead to greater cryptanalysis resistance</li></ul></li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="47-data-encryption-standard-des"></a>4.7 Data Encryption Standard (DES)<a aria-hidden="true" tabindex="-1" class="hash-link" href="#47-data-encryption-standard-des" title="Direct link to heading">#</a></h3><ul><li>Overview<ul><li>Use the Feistel structure<ul><li>Block length $n=64$, key size $k=56$.</li><li>Number of rounds is $16$.</li></ul></li></ul></li><li>S-box (substitution-box)<ul><li>Outer bits: two bits (the first and last bits)</li><li>Inner bits: the other four bits between the first and last bits</li><li>e.g.: $011011$, outer bits are $01$, inner bits are $1101$.</li></ul></li></ul><p>![S-box]({{ site.baseurl }}/assets/resources/SOEN321/S_box.png)</p><ul><li><p>Double/Triple encryption (DES)</p><ul><li><p>The security of DES depends on its large key space.</p></li><li><p>Double encryption should <strong><em>double</em></strong> the size ($2^{112}$) of the key space?</p></li><li><p>$C=E<em>{k_2}(E</em>{k_1}(P))$</p><p>![Double/Triple encryption]({{ site.baseurl }}/assets/resources/SOEN321/D_T_encryption.png)</p></li><li><p>Meet-in-the-middle attack (DES)</p><ul><li><p>Double-DES: $M=E<em>{k_1}(P)=D</em>{k_2}(C)$</p><ol><li>Compute and store $E_{K_1}(P)$ for all possible $K_1$</li><li>Compute and store $D_{K_2}(C)$ for all possible $K_2$</li><li>Match</li><li>Reduces key search from $2^{2k}$ to $2^k$ at the expense of addition storage $2^k$.</li></ol></li><li><p>Triple encryption: Security of $2^{112}$</p></li></ul></li></ul></li><li><p>Alternative to DES</p><ul><li>Double-DES - no security advantage</li><li>Triple-DES - secure, but slow</li><li>So, Advanced Encryption Standard (AES)</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="48-advanced-encryptioin-standard-aes"></a>4.8 Advanced Encryptioin Standard (AES)<a aria-hidden="true" tabindex="-1" class="hash-link" href="#48-advanced-encryptioin-standard-aes" title="Direct link to heading">#</a></h3><ul><li><p>Overview</p><ul><li>Block length: $128$<ul><li>Consider it as a $4\times4$ matrix of bytes: $4\times4=16\text{ bytes}, 16\times8=128\text{ bits}$</li></ul></li><li>Key length: AES-128 (n=10), AES-192 (n=12), AES-256 (n=14)</li></ul></li><li><p>How to</p><ol><li><p>Derive round kyes (KeyExpansion): State = X(input)</p></li><li><p>Initial round: AddRoundKey(State, $Key_0$): State $\oplus$ Expanded key</p></li><li><p>Rounds (Nr-1 times)</p><ol><li><p>SubBytes(State, S-box): a substitution step</p><ul><li>Each byte in the state is replaced with its entry in a fixed 8-bit lookup table S (substitution box or S-box).</li><li>Provides non-linearity.</li></ul><p>![SubBytes]({{ site.baseurl }}/assets/resources/SOEN321/SubBytes.png)</p></li><li><p>ShiftRows(State): a transpositioin step</p><ul><li>Avoid the columns being encrypted independently.</li></ul><p>![ShiftRows]({{ site.baseurl }}/assets/resources/SOEN321/ShiftRows.png)</p></li><li><p>MixColumns(State): </p><ul><li>Each column of the state is multiplied with a fixed polynomial.</li><li>Together ShiftRows, MixColumns provides diffusion.</li></ul><p>![MixColumns]({{ site.baseurl }}/assets/resources/SOEN321/MixColumns.png)</p></li><li><p>AddRoundKey(State, $Key_R$):</p><ul><li>The round subkey is combined with the state using bitwise XOR</li><li>For each round, a subkey is derived from the main key using Rijndael&#x27;s key schedule</li></ul><p>![AddRoundKey]({{ site.baseurl }}/assets/resources/SOEN321/AddRoundKey.png)</p></li></ol></li><li><p>Final Round (no MixColumns)</p><ol><li>SubBytes</li><li>ShiftRows</li><li>AddRoundKey</li></ol></li><li><p>Y(output) = State</p></li></ol></li><li><p>Attack</p><ul><li>No practical attacks to date</li><li>No attacks on full AES versions</li></ul></li></ul><hr><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="5-hash-functions"></a>5. Hash Functions<a aria-hidden="true" tabindex="-1" class="hash-link" href="#5-hash-functions" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="51-what-it-is"></a>5.1 What it is<a aria-hidden="true" tabindex="-1" class="hash-link" href="#51-what-it-is" title="Direct link to heading">#</a></h3><ul><li>Input: a string $M$ of arbitrary length, called the <em>preimage</em>.</li><li>Output: a string $h(M)$ of fixed length, called <em>hash-value</em>, <em>hash-code</em>, <em>hash-result</em>, or <em>hash</em>.</li><li>Collsions: $h(M)$ is a many-to-one function<ul><li>Assume $t$ to $n$, and $h$ is random.</li><li>$2^t$ input, $2^n$ output, so $2^{t-n}$ inputs would map to the same output.</li><li>Collisions probability: $1/2^{n}$</li></ul></li><li>Properties:<ol><li>Compression</li><li>Ease of computation</li><li>Pre-image resistance (one-way property)<ul><li>Given $y$, to find any pre-image $x&#x27;$ such that $h(x&#x27;)=y$.</li><li>But remember: there are no known provably one-way functions.</li></ul></li><li>Second pre-image resistance (Weak collision resistance)<ul><li>Given $x$, to find a 2nd-preimage $x&#x27;$ where $x&#x27;\neq x$ such that $h(x&#x27;)=h(x)$.</li></ul></li><li>Collision resistance (Strong collision resistance)<ul><li>Find any $x&#x27;, x$ where $x&#x27;\neq x$ such that $h(x&#x27;)=h(x)$.</li><li>Need to guess $2^{n/2}$ inputs before finding a collision (birthday paradox).</li></ul></li></ol></li><li>Examples:<ol><li>MD5: 128-bit hash</li><li>SHA-1: 160-bit hash</li><li>SHA-2 (SHA-256): 256/384/512-bit hash</li><li>SHA-3</li></ol></li><li>Attack<ol><li>Dishonest signer<ul><li>Signs $x_1$, later claims signed $x_2$ instead.</li></ul></li><li>Dishonest verifier<ul><li>Gets signature on $x_1$, later claims signature on $x_2$.</li></ul></li></ol></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="52-classification"></a>5.2 Classification<a aria-hidden="true" tabindex="-1" class="hash-link" href="#52-classification" title="Direct link to heading">#</a></h3><ul><li>keyed<ul><li>Message authentication (MACs)</li><li>Other applications</li></ul></li><li>Unkeyed<ul><li>Modification detection (MDCs)<ul><li>One-way hash function (OWHF)<ul><li>Preimage and 2nd-preimage resistance</li><li>$n\geq128$</li></ul></li><li>Collision resistant hash function (CRHF)<ul><li>2nd-preimage and collision resistance</li><li>$n\geq256$ because of birthday paradox ($2^{256/2}=2^{128}$).<ul><li>Assumptions: $2^{128}$ operations are infeasible. </li></ul></li></ul></li></ul></li><li>Other applications</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="53-how-to-build-a-hash-function"></a>5.3 How to build a hash function<a aria-hidden="true" tabindex="-1" class="hash-link" href="#53-how-to-build-a-hash-function" title="Direct link to heading">#</a></h3><ol><li>Modular arithmetic</li><li>Block ciphers</li><li>Dedicated design</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="54-general-structure-of-iterated-hash-functions"></a>5.4 General structure of iterated Hash Functions<a aria-hidden="true" tabindex="-1" class="hash-link" href="#54-general-structure-of-iterated-hash-functions" title="Direct link to heading">#</a></h3><p>![Iterated Hash Functions]({{ site.baseurl }}/assets/resources/SOEN321/Iterated_Hash_function.png)</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="the-merkledamgård-md-construction-of-hash-functions"></a>The Merkle–Damgård (MD) Construction of hash functions<a aria-hidden="true" tabindex="-1" class="hash-link" href="#the-merkledamgård-md-construction-of-hash-functions" title="Direct link to heading">#</a></h4><p>![Merkle–Damgård Construction]({{ site.baseurl }}/assets/resources/SOEN321/MD_Scheme.png)</p><ul><li><p>How</p><ol><li>Padding, because compressions functions cannot handle inputs of arbitrary size.</li><li>Divide into equal parts.</li><li>$H<em>i=f(H</em>{i-1}, M_i)$</li></ol></li><li><p>Properties:</p><ul><li>If $f$ is collision resistant, so is $h$.</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="55-hash-functions-based-on-block-ciphers"></a>5.5 Hash functions based on block ciphers<a aria-hidden="true" tabindex="-1" class="hash-link" href="#55-hash-functions-based-on-block-ciphers" title="Direct link to heading">#</a></h3><ul><li>Why<ul><li>Trust</li><li>Reduce design, evaluation, and implementation effort</li><li>Compact implementation</li></ul></li><li>Why not<ul><li>Slow</li><li>weaknesses which are not relevant to encryption<ul><li>Block cipher could become weaken when used in $h()$.</li></ul></li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="56-applications"></a>5.6 Applications<a aria-hidden="true" tabindex="-1" class="hash-link" href="#56-applications" title="Direct link to heading">#</a></h3><ul><li>Data integrity<ul><li>Messages</li><li>Files</li></ul></li><li>Confirmation of knowledge<ul><li>Passwords</li></ul></li><li>PRBGs: Cryptographically secure pseudo-random bit sequences generator<ul><li>Hash functions are designed to be “random functions” of the input.</li><li>Examples: <code>/dev/random</code>, <code>/dev/urandom</code> (Linux)<ul><li>Acting as an entropy pool.</li><li><code>/dev/random</code> blocks when no bits available, but <code>/dev/urandom</code> keeps going by SHA-1 (later by ChaCha20).</li></ul></li><li>Seed<ul><li>Avoid to use a simple value that an attacker could guess, e.g.:<ul><li>System time</li><li>Process ID</li></ul></li></ul></li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="57-pre-computation-attacks-rainbow-table-hash-chain-attacks"></a>5.7 Pre-computation attacks (Rainbow-table hash-chain attacks)<a aria-hidden="true" tabindex="-1" class="hash-link" href="#57-pre-computation-attacks-rainbow-table-hash-chain-attacks" title="Direct link to heading">#</a></h3><ul><li>How to<ul><li>Pre-compute all hash values under given inputs, and only store some fraction to save space (space-time tradeoff) to optimize future search.</li><li>Variable-length messages do not generally have this problem, since input space is large<ul><li>Example: passwords have a fixed size, rainbow-table can be applied.</li></ul></li></ul></li><li>Protect against pre-computation: salts<ul><li>Random value $s$ prepended to $p$ prior to calculating hash: $h(s||p)$.</li><li>So an attacker would need to build a table for each possible salt value.</li></ul></li></ul><hr><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="6-message-authentication-code-mac"></a>6. Message Authentication Code (MAC)<a aria-hidden="true" tabindex="-1" class="hash-link" href="#6-message-authentication-code-mac" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="61-what-it-is"></a>6.1 What it is<a aria-hidden="true" tabindex="-1" class="hash-link" href="#61-what-it-is" title="Direct link to heading">#</a></h3><ul><li>Keyed hash functions are called MACs, which use both $M$ and a key $k$ as input.</li><li>Why need it<ul><li>Encryption alone does not provide data integrity.</li></ul></li><li>Goal<ul><li>add authentication to the hash-value by using a secret (symmetric) key.</li></ul></li><li>Properties<ul><li>Should be difficult to create a valid MAC without knowledge of secret key</li></ul></li><li>Usage<ul><li>Message authentication: Alice sends $M || h_k(M)$</li><li>Message authentication and confidentiality, where authentication is tied to:<ul><li>Plaintext: $E<em>{k_2}(M||h</em>{k_1}(M))$</li><li>Ciphertext: $E<em>{k_2}(M)||h</em>{k<em>1}(E</em>{k_2}(M))$</li></ul></li><li>Weakness: Does not provide non-repudiation</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="62-mdc-vs-mac"></a>6.2 MDC vs MAC<a aria-hidden="true" tabindex="-1" class="hash-link" href="#62-mdc-vs-mac" title="Direct link to heading">#</a></h3><ul><li>MDC should not be used for a MAC</li><li>$MAC=h(k||x)$: <a href="https://en.wikipedia.org/wiki/Length_extension_attack" target="_blank" rel="noopener noreferrer">length-textension attack</a><ol><li>$h$ is an interated MDC with compression function $f$.</li><li>$y$ is an attacker-controlled message.</li><li>Attacker can computer $f(MAC,y)$ to obtain $MAC&#x27;=h(k||x||y)$ without knowing $k$.</li></ol></li><li>$MAC=h(x||k)$: collision<ul><li>Collision in the hash function will lead to a collision in the MAC.</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="63-hash-based-mac"></a>6.3 Hash-based MAC<a aria-hidden="true" tabindex="-1" class="hash-link" href="#63-hash-based-mac" title="Direct link to heading">#</a></h3><p><a href="https://en.wikipedia.org/wiki/HMAC" target="_blank" rel="noopener noreferrer">HMAC</a></p><ul><li>$HMAC(x)=h\big(k||p_1||h(k||p_2||x)\big)$<ul><li>$k$ is the key $K$ padded with zeros on left so it has length of 1 block for compression function.</li><li>$p_1, p_2$ are distinct repeated byte strings of length $b$</li><li>$h$ any cryptographic hash function</li></ul></li><li>SHA-3 itself is immune to length extension attacks, so $MAC=SHA3(key||message)$ would be sufficient. </li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="64-mac-from-block-ciphers-cbc-mac"></a>6.4 MAC from block ciphers: CBC MAC<a aria-hidden="true" tabindex="-1" class="hash-link" href="#64-mac-from-block-ciphers-cbc-mac" title="Direct link to heading">#</a></h3><ul><li>Problematic if<ul><li>Weak block cipher is used (e.g. DES)</li><li>Message length is variable</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="65-password-based-key-derivation-function-pbkdf2"></a>6.5 Password-Based Key Derivation Function (PBKDF2)<a aria-hidden="true" tabindex="-1" class="hash-link" href="#65-password-based-key-derivation-function-pbkdf2" title="Direct link to heading">#</a></h3><ul><li>$DK=PBKDF2(PRF,P,S,c,dkLen)$<ul><li>$PRF$: hash or MAC function</li><li>$P$: Password</li><li>$S$: Salt value</li><li>$c$: Number of iterations</li><li>$dkLen$: required key length</li></ul></li></ul><hr><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="7-public-key-cryptography-and-ssl"></a>7. Public Key Cryptography and SSL<a aria-hidden="true" tabindex="-1" class="hash-link" href="#7-public-key-cryptography-and-ssl" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="71-overview"></a>7.1 Overview<a aria-hidden="true" tabindex="-1" class="hash-link" href="#71-overview" title="Direct link to heading">#</a></h3><ul><li>Why<ul><li>In symmetric key systems, we have to share a secret key that nobody else knows.</li><li>Split this key into two pieces, one is public, the other is private.</li></ul></li><li>How<ul><li>Uses number theoretic concepts: factoring, quadratic residue, RSA/DH problems</li></ul></li><li>It is asymmetric cryptography.</li><li>Symmetric vs. public key Cryptography<ul><li>Keys in symmetric cryptosystem<ul><li>random bit strings</li><li>no special mathematical properties</li><li>generation is relatively easy</li></ul></li><li>Keys in asymmetric cryptosystem<ul><li>have speical mathematical properties</li><li>generation is computationally expensive</li></ul></li><li>Key sizes are not comparable<ul><li>RSA-1024</li><li>AES-128</li><li>But still AES-128 is better</li></ul></li></ul></li><li>Advantages<ul><li>Only private key must be secret<ul><li>Still, authenticity of public key must be guaranteed.</li></ul></li><li>The number of keys required is smaller than if symmetric keys used in large networks.<ul><li>Symmetric: Every pair of 2 people need a different key, $\binom{n}{2}=n(n-1)/2\in O(n^2)$</li><li>Public key system: Every one has a key pair: $2n\in O(n)$</li></ul></li></ul></li><li>Disadvantages<ul><li>Speed: Encryption is much slower than symmetric ciphers.</li><li>Key sizes are typically much larger</li><li>No public key cipher proven to be secure (although the same can be said for block ciphers)</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="72-public-key-cryptography"></a>7.2 Public Key Cryptography<a aria-hidden="true" tabindex="-1" class="hash-link" href="#72-public-key-cryptography" title="Direct link to heading">#</a></h3><ul><li>Uses two different keys: one publie $K_e$, the other private $K_d$<ol><li>Alice generate $K_d$ only known to her.</li><li>Alice generate $K_e$ which she publishes, avaliable to both Bob and Oscar.</li><li>Knowledge of $K_e$ does not reveal $K_d$, or even given an advantage to Oscar trying to find $K_d$.</li><li>Alternatvie notation for Alice&#x27;s keys: $K_A, {K_A}^{-1}$.</li></ol></li><li>Theory: trapdoor one-way function<ul><li>A function $f:\{0,1\}^<em> \rightarrow \{0,1\}^</em>$ is a trapdoor one-way function if and only if $f(x)$ is a one-way function.</li><li>Given some extra information, it becomes feasible to compute $f^{-1}$.</li><li>Public key cyrptography relies on trapdoor one-way function.</li></ul></li><li>Applications<ul><li>Encryption: let anayone send you a message that only you can read.</li><li>Signature: let anyone verify that a message is from you.</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="73-public-key-encryption"></a>7.3 Public Key Encryption<a aria-hidden="true" tabindex="-1" class="hash-link" href="#73-public-key-encryption" title="Direct link to heading">#</a></h3><ul><li>Public-Private Key Pairs Properties<ol><li>Should be infeasible to find decryption key given encryption key and algorithm.</li><li>Public key schemes utilise problems that are easy (P type) in one way but hard (NP type) in the other way, eg:<ul><li>Exponentiation vs. logs</li><li>Multiplication vs. factoring</li></ul></li></ol></li><li>How<ol><li>Alice wants to send a message $M$ to Bob. She knows his public key $K_{e,Bob}$ since it is public.</li><li>Alice encrypts $M$ using $K_{e,Bob}$ producing $C$.</li><li>Bob decrypts $C$ using $K<em>{d,Bob}$, a private key generated by Bob that corresponds to $K</em>{e,Bob}$.<ul><li>Only $K<em>{d,Bob}$ can decrypt a message encrypted with $K</em>{e,Bob}$.</li><li>Notice this means that even Alice cannot decrypt $C$.</li></ul></li></ol></li></ul><p>![Public Key Encryption]({{ site.baseurl }}/assets/resources/SOEN321/Public_Key_Encryption.png)</p><ul><li>Attack: Man-in-the-middle attack (MITM)<ul><li>Substitute different public keys between two users</li><li>Adversary: $(e&#x27;, d&#x27;)$</li><li>All public key systems are vulnerable to MITM, must use <strong><em>authentic</em></strong> public keys.</li></ul></li></ul><p>![Public Key Encryption MITM]({{ site.baseurl }}/assets/resources/SOEN321/Public_Key_Encryption_MITM.png)</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="74-public-key-signatures"></a>7.4 Public Key Signatures<a aria-hidden="true" tabindex="-1" class="hash-link" href="#74-public-key-signatures" title="Direct link to heading">#</a></h3><ul><li>Signatures are for integrity and authentication of a message.</li><li>Alice uses her private key $K<em>{d,Alice}$ to sign $M$ to produce $Sign</em>{Alice}(M)$.</li><li>Bob uses Alice&#x27;s public key $K<em>{e,Alice}$ to verify $Sign</em>{Alice}(M)$.</li><li>Typical usage mode:<ul><li>Practically, the entire message is not encrypted with a public key, or signed with a private key<ul><li>Reason: Computational expense</li></ul></li><li>Encryption: encrypt a symmetric key using the public key, then the message encrypted with the symmetric key.</li><li>Signature: sign $H(M)$ instead of $M$.</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="75-diffie-hellman-key-exchange-d-h-key-exchange"></a>7.5 Diffie-Hellman Key Exchange (D-H Key Exchange)<a aria-hidden="true" tabindex="-1" class="hash-link" href="#75-diffie-hellman-key-exchange-d-h-key-exchange" title="Direct link to heading">#</a></h3><p>![D-H Key Exchange]({{ site.baseurl }}/assets/resources/SOEN321/D_H_Key.png)</p><ul><li>Overview<ul><li>Enables two parties to jointly establish a shared secret key, no prior shared secret</li><li>Based on exponentiation in a finite field (modulo a prime)</li><li>Weakness: no authentication</li><li>Security relies on the difficulty of computing discrete logarithms (similar to factoring)</li></ul></li><li>How it works<ul><li>$p$, a large prime integer, public</li><li>$g$, a primitive root mod $p$, public (also called a generator)</li><li>Session key is then obtained by both parties calculating:<ul><li>$a,b$ are private to Alice and Bob respectively</li><li>$K_{ab}=g^{ab}\pmod p$</li><li>Alice can compute $K_{ab}={g^{b}}^a\pmod p$</li><li>Bob can compute $K_{ab}={g^{a}}^b\pmod p$</li></ul></li><li>$\{Message, Password\}_k$</li></ul></li><li>Attack<ul><li>The attacker needs either $a$ or $b$ to compute $K_{ab}$.</li><li>Or Man in the Middle</li></ul></li></ul><p>![D-H Man in the Middle]({{ site.baseurl }}/assets/resources/SOEN321/mitm.png)</p><ul><li><strong><em>D-H Man in the Middle</em></strong><ul><li>Why it works? No authentication</li><li>How it works?<ol><li>Alice sent $g^a$, Eve sent $g^{a&#x27;}$, Bod received $g^{a&#x27;}$</li><li>Bob sent $g^b$, Eve sent $g^{b&#x27;}$, Alice received $g^{b&#x27;}$</li></ol></li><li>How it can be solved?<ul><li>Sign the $g^a$ and $g^b$ because the sign key is private.</li><li>But have to share the key, leads to new problem</li></ul></li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="76-password-authenticated-key-exchange"></a>7.6 Password Authenticated Key Exchange<a aria-hidden="true" tabindex="-1" class="hash-link" href="#76-password-authenticated-key-exchange" title="Direct link to heading">#</a></h3><ul><li><p>Definition</p><ul><li>Two parties share only a weak/low-entropy secret, e.g., a password</li><li>Establish a secure channel between the users using only the shared secret and mutual authentication</li><li>The channel must be protected by a high-entropy session key</li><li>Offline guessing attacks on the weak secret must be infeasible</li></ul></li><li><p>But how to derive a high-entropy secret from a low entropy one?</p></li><li><p>Example</p><ul><li>Password: 8 bits</li><li>Generation: sha256(password) generates 256 bits to be used as a key</li><li>But no need to guess $2^{256}$</li><li>Still only guess $2^{8}$, then use sha256 to generate a key to test (need a testable sample)</li></ul></li><li><p>Authenticated Diffie-Hellman (DH encrypted key exchange)</p></li><li><p>Shared passwod</p><ul><li>$A\rightarrow B: A,g,p,\{g^a \pmod p \}_{pwd}$</li><li>$B\rightarrow A: B,\{g^b \pmod p \}_{pwd}$</li><li>$A\rightarrow B: \{C_A\}_K$</li><li>$B\rightarrow A: \{C_A, C_B\}_K$</li><li>$A\rightarrow B: \{C_B\}_K$</li></ul></li><li><p>Achieves:</p><ul><li>Mutual authentication</li><li>Strong session key</li><li>No offline attacks on PWD</li><li>Key confirmation</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="77-rsa"></a>7.7 RSA<a aria-hidden="true" tabindex="-1" class="hash-link" href="#77-rsa" title="Direct link to heading">#</a></h3><ul><li>Theory<ul><li>Based on intractability of the integer factor factorization problem</li></ul></li><li>Key generation<ol><li>Generate 2 large and distinct primes $p$ and $q$, each roughly the same size.<ul><li>What if one number is not large? (Then, would be too easy to find the other number)</li></ul></li><li>Compute $n=pq$ and $\Phi(n)=(p-1)(q-1)$.<ul><li>$\Phi(n)$ is a relative prime to $n$.<ul><li>e.g.: $\Phi(5\times 7)=4\times 6 = 24$</li></ul></li></ul></li><li>Select a random integer $e: 1&lt; e &lt; \Phi(n) $<ul><li>gcd$(e,\Phi(n))=1$</li><li>$e$ can be small for encryption efficiency.</li></ul></li><li>Use extended Euclidean algorithm (HAC) to computer the unique integer $d,1&lt; d &lt;\Phi(n)$, such that $ed\equiv1\pmod{\Phi(n)}$.</li><li>Keys<ul><li>Public key is $(e,n)$.</li><li>Private key is $d$.</li></ul></li></ol></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="78-rsa-encryption"></a>7.8 RSA Encryption<a aria-hidden="true" tabindex="-1" class="hash-link" href="#78-rsa-encryption" title="Direct link to heading">#</a></h3><ul><li>How it works<ul><li>Bob encryption<ol><li>Get Alice&#x27;s authentic public key $(e,n)$</li><li>Take the message $M$ and represent it as an integer $m$ in the interval $[0, n-1]$.<ul><li>If $M$ cannot be represented in $[0, n-1]$, separate $M$ into blocks.</li></ul></li><li>Computer $c=m^e\pmod n$.</li><li>Send $c$ to Alice.</li></ol></li><li>Alice decryption<ol><li>Compute $m=c^d\pmod n$.</li></ol></li></ul></li><li>Why it works<ol><li>Since $ed\equiv1\pmod{\Phi(n)}$, there exists an integer $k$ such that $ed\equiv1+k\cdot \Phi(n)$</li><li>$c^d=m^{ed}=m^{1+k\cdot \Phi(n)}=m^1\cdot m^{k\cdot \Phi(n)}=m^1\cdot (m^{\Phi(n)})^k=m^1\cdot (1)^k=m$<ul><li>Euler&#x27;s theorem: $m^{\Phi(n)}\pmod n =1$ where $gcd(\Phi(n),n)=1$</li></ul></li></ol></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="79-digital-signature"></a>7.9 Digital Signature<a aria-hidden="true" tabindex="-1" class="hash-link" href="#79-digital-signature" title="Direct link to heading">#</a></h3><ul><li>Scheme:<ul><li>a secret signing key and a public verfication key</li></ul></li><li>Service provided:<ul><li>Authentication</li><li>Data integrity</li><li>Non-Repudiation (MAC does not provide this)<ul><li>$\text{HMAC}_k(M)$, ?</li><li>$\text{Sign}_A(M)$, because the private key is from the signer</li></ul></li></ul></li><li>Problem<ul><li>How do we obtain someone&#x27;s public key over a network, in a way that we can trust it belongs to the claimed entity?</li><li>Certificates<ul><li>Relies on a set of trusted third-party certificate authorities to establish the authenticity of certificates.</li><li>Source is normally a trusted third party (also called: certificate authority (CA)).</li><li>Root certificates are self-signed.</li></ul></li></ul></li><li>Categories<ul><li><a href="https://crypto.stackexchange.com/questions/8820/signature-with-appendix" target="_blank" rel="noopener noreferrer">With appendix</a>: the signature $s$ of the message $M$ is usually appended to the unmodified message $M$. So $(M,s)$ or $M||s$ is sent.</li><li>With message recovery: all or some of the message is embedded in the signature. When all of the message is embedded, the verification procedure requires only $s=Sign(M,PrivateKey)$ as input, and recovers $M$ as a by-product (that&#x27;s known as total message recovery). Only the signature is sent; it embeds the message.</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="710-rsa-signature"></a>7.10 RSA Signature<a aria-hidden="true" tabindex="-1" class="hash-link" href="#710-rsa-signature" title="Direct link to heading">#</a></h3><ul><li>Overview<ul><li>$R$: a redundancy function, maps message $M$ to RSA inputs.</li><li>No confidentiality: anyone with Alice&#x27;s public key can recover the message $M$.</li><li>Authentication and integrity guarantees: only the holder of Alice&#x27;s private key can create a valid mesage that has a signature verifiable with her public key.</li></ul></li><li>How it works<ul><li>Alice wants to sign a message $M$:<ul><li>Computes $M&#x27;=R(M)$.</li><li>Computes $s={(M&#x27;)}^d \pmod n$.</li><li>Alice&#x27;s signature for $M$ is $s$.</li></ul></li><li>Bob wants to verifty:<ul><li>Obtains Alice&#x27;s public key $(e,n)$.</li><li>Computes $M&#x27;=s^e \pmod n$.</li><li>Verifies that $M&#x27;$ is in the redundancy space.</li><li>Recovers $M=R^{-1}(M&#x27;)$.</li></ul></li></ul></li><li>RSA signature with Appendix<ul><li>Alice calculates $h(M)$.</li><li>Alice signs $s=Sign(h(M))$.</li><li>Alice transmits $(M,s)$.</li><li>Bob can verify message by calculating $h(M)$ and comparing $h(M)$ to the verified signautre.</li><li>PGP (Pretty Good Privacy) uses it to create signautre on email.</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="711-ssl"></a>7.11 SSL<a aria-hidden="true" tabindex="-1" class="hash-link" href="#711-ssl" title="Direct link to heading">#</a></h3><ul><li>Properties<ul><li>What it has<ol><li>Confidentiality</li><li>Message authenticity</li><li>Authentication<ul><li>Server authentication</li><li>Client authentication</li></ul></li></ol></li><li>What it hasn&#x27;t<ol><li>Non-repudiation</li><li>Availability</li></ol></li></ul></li><li>Architecutre<ul><li>between Application layer (HTTP/LDAP/POP3) and Transport layer (TCP)</li></ul></li></ul><hr><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="8--usability-and-human-factors-in-security"></a>8.  Usability and human factors in security<a aria-hidden="true" tabindex="-1" class="hash-link" href="#8--usability-and-human-factors-in-security" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="81-pretty-good-privacy-pgp"></a>8.1 Pretty Good Privacy (PGP)<a aria-hidden="true" tabindex="-1" class="hash-link" href="#81-pretty-good-privacy-pgp" title="Direct link to heading">#</a></h3><ul><li><p>Steps:</p><ol><li>Install PGP/GPG/OpenPGP</li><li>Generate/import key pairs</li><li>Protect your private keys</li><li>Integrate/enable in your mail client</li><li>Publish your public key</li><li>Collect public keys of your contacts</li></ol></li><li><p>Encryptoin/Decryption
![PGP]({{ site.baseurl }}/assets/resources/SOEN321/pgp.png)</p></li><li><p><a href="https://www.cs.berkeley.edu/~tygar/papers/Why_Johnny_Cant_Encrypt/OReilly.pdf">Why Johnny Can’t Encrypt</a>: A Usability Evaluation of PGP 5.0</p><ul><li>Hypothesis: effective security requires a different usability standard, and that it will not be achieved through the user interface design techniques</li><li>Conclusions:<ol><li>“making security usable will require the development of domain-specific user interface design principles and techniques”</li><li>“user interface design for effective security remains an open problem”</li></ol></li><li>Usability for security: Security software is usable if the people who are excepted to use it:<ol><li>are reliably made aware of the security tasks they need to perform;</li><li>are able to figure out how to successfully perform those tasks;</li><li>don&#x27;t make dangerous errors; and</li><li>are sufficiently comfortable with the interface to continue using it.</li></ol></li><li>Problematic properties of security<ol><li>The unmotivated user property<ul><li>Secondary goal (security is not important)</li><li>Optimistic view (security is working; nothing to hide)</li><li>Get help from psychology studies (user capabilities: users cannot remeber long password or users do not know a strong password; how to motivate people)</li></ul></li><li>The abstraction property<ul><li>Policies are abstract</li><li>Policies vs. implementation</li></ul></li><li>The lack of feedback property<ul><li>How to design effective warning dialogs</li><li>How to communicate system state</li><li>Too much feedback can also be bad</li></ul></li><li>The <strong>barn door</strong> property<ul><li>Once a secret has been left accidentally, even for a short time, it&#x27;s useless now.</li></ul></li><li>The weakest link property<ul><li>A single user error is enough to defeat a system</li><li>Users must follow all security guidelines</li></ul></li></ol></li><li>Expected usability standard for PGP<ol><li>understand encrypt/decrypt</li><li>understand authentication</li><li>understand generate key pair</li><li>understand publish their public key</li><li>understand acquire public keys</li><li>manage to avoid dangerous errors</li><li>be able to succeed at all of the above within a few hours of reasonably motivated effort.</li></ol></li><li>PGP&#x27;s usability evaluation methods<ul><li>Cognitive walkthrough<ul><li>Simulated use by a domain expert</li><li>Step throug the use of the software</li><li>Learnability evaluation</li></ul></li><li>Cognitive walkthrough: Findings<ul><li>Irreversible actions<ul><li>Accidentally deleting the private key</li><li>Accidentally publicizing a key</li><li>Accidentally revoking a key</li><li>Forgetting the pass phrase (public keys collected from others)</li><li>Failing to back up the key rings</li><li>Sending a message to wrong recipients</li><li>Sending a confidential message as plaintext</li><li>Failing in signature verfication</li><li>Failong in revocation check</li><li>Trusting the wrong keys</li></ul></li><li>Consistency of terminologies<ul><li>Encoding vs. encrypting</li></ul></li><li>&quot;Too much information&quot;<ul><li>Define what is important and what is not</li><li>Basic, intermediate, and advanced levels in UI</li></ul></li></ul></li><li>User study<ul><li>Test with real users</li></ul></li><li>User study results<ul><li>Dangerous errors<ul><li>3/12 sent confidential message in plaintext</li><li>2 realized the mistake; one did not</li><li>1 forgot the passphrase</li></ul></li><li>Figuring out how to encrypt with any key<ul><li>1/12 failed to encrypt at all</li><li>2 took close to half an hour</li></ul></li><li>Figuring out the correct key to encrypt with<ul><li>7/11 used their own keys</li><li>1 generated key pairs for others</li></ul></li><li>Decrypting an email message<ul><li>2/5 succeeded</li></ul></li><li>Deciding whether to trust keys from the key server<ul><li>3/8 members expressed concern</li></ul></li></ul></li></ul></li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="82-human-as-an-attack-vector"></a>8.2 Human as an attack vector<a aria-hidden="true" tabindex="-1" class="hash-link" href="#82-human-as-an-attack-vector" title="Direct link to heading">#</a></h3><ul><li>Why<ul><li>Real attacks exploit psychology and technology</li><li>Phishing, vishing</li><li>Targeted vs. generic</li><li>Easy to launch online &quot;imitation&quot; attacks</li><li>Deception history</li></ul></li><li>Attacker&#x27;s goals<ul><li>Information extraction</li><li>malware infection<ul><li>APT (Advanced persistent threat)</li><li>Long-term attack vector</li></ul></li><li>Stealth</li><li>monetary gains</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="83-phishing"></a>8.3 Phishing<a aria-hidden="true" tabindex="-1" class="hash-link" href="#83-phishing" title="Direct link to heading">#</a></h3><ul><li><a href="http://www.eecs.berkeley.edu/~tygar/papers/Phishing/why_phishing_works.pdf">Why</a><ul><li>Natural trust: attacks via &quot;trusted&quot; contacts</li><li>Target the vulnerables: elderly, young-adults, low-income</li><li>Fit with natural work-flow<ul><li>How to detect phishing emails when banks also send similar emalis</li></ul></li><li>Greed</li><li>Social validation</li></ul></li><li>Phishing user study<ol><li>Good phishing websites fooled 90% of participants.</li><li>Existing anti-phishing browsing cues are ineffective.</li><li>On average, the participant group made mistakes on the test set 40$ of the time.</li><li>Popup warnings about fraudulent certificates were ineffective.</li><li>Neither education, age, sex, previous experience, nor hours of computer use showed a statistically significant correlation with vulnerability to phishing.</li></ol></li><li>Analysis of past attacks<ol><li>Victims&#x27; lack of knowledge</li><li>Visual deception</li><li>Bounded attention<ul><li>Too many indicators for different types of security issues</li></ul></li></ol></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="84-the-rsa-secureid-hack-hardware-authentication-token"></a>8.4 The RSA SecureId Hack (Hardware authentication token)<a aria-hidden="true" tabindex="-1" class="hash-link" href="#84-the-rsa-secureid-hack-hardware-authentication-token" title="Direct link to heading">#</a></h3><ul><li>What it is<ul><li>Hardware authentication token</li><li>Dynamic code</li></ul></li><li>Use of RSA SecurID<ul><li>Second factor</li><li>Side notes: three factors of authentication<ul><li>Something you <strong><em>know, have, are</em></strong></li></ul></li></ul></li><li>Issue<ul><li>Auth servers must be in sync and hall <strong><em>all</em></strong> seeds</li></ul></li><li>Biometrics authentication<ul><li>Once compormised, it cannot be replaced.</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="85-deception"></a>8.5 Deception<a aria-hidden="true" tabindex="-1" class="hash-link" href="#85-deception" title="Direct link to heading">#</a></h3><ul><li>What it is<ul><li>Planned actions to mislead attackers and</li><li>To cause them to:<ul><li>Confuse</li><li>Take/avoid specific actions</li></ul></li><li>Must be mixed with some “truth”</li><li>Attackers must be given “hope”</li></ul></li><li>Advantages<ul><li>False info can reduce value of leaked databases</li><li>Learning the attacker’s moves</li><li>Slow down the attacker</li></ul></li></ul><hr><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="9-botnets-and-ddos"></a>9. Botnets and DDoS<a aria-hidden="true" tabindex="-1" class="hash-link" href="#9-botnets-and-ddos" title="Direct link to heading">#</a></h2><p>![Bot nets]({{ site.baseurl }}/assets/resources/SOEN321/botnets.png)</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="91-botnets"></a>9.1 Botnets<a aria-hidden="true" tabindex="-1" class="hash-link" href="#91-botnets" title="Direct link to heading">#</a></h3><ul><li><p>What it is</p><ul><li>Bot v.s. malware<ul><li>Bot is controlled by someone remotely</li><li>malware not</li></ul></li><li>Botnets: networks of infected end-hosts, called bots, that are under the control of a human operator commonly known as a <em>botmaster</em>.    </li><li>Bot software: advanced malware that makes the funcationality of a compromised host available to the botmaste.</li></ul></li><li><p>Features</p><ul><li>propagate like worms</li><li>hide from detection like many viruses</li><li>attack like many stand-alone tools</li><li>have an integrated <strong><em>command and control system</em></strong></li></ul></li><li><p>How to infect</p><ul><li>&quot;curious George&quot; attacks</li><li>Backdoors from a previous infection</li><li>Trojaned applications</li><li>OS/browser/application vulnerabilities</li><li>Open file shares</li><li>P2P networks</li></ul></li><li><p>How to control: </p><ul><li><p>Centralized</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">* Better control</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">* Efficient attacks</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">* Single-point vulnerability</span></div></div></div></div></div><p>![Bot center]({{ site.baseurl }}/assets/resources/SOEN321/bot_center.png)</p></li><li><p>P2P</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">* robust againt disruption</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">* Inefficient</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">* unreliable from attackers&#x27; viewpoint</span></div></div></div></div></div><p>![Bot P2P]({{ site.baseurl }}/assets/resources/SOEN321/bot_p2p.png)</p></li><li><p>Hybrid: mixture of centralized and P2P</p></li></ul></li><li><p>How to protect masterbot: Dynamic domain names</p><ul><li>A single domain is problematic</li><li>Multiple domains do not help<ul><li>Names can be learned in advanced and blocked</li><li>Bots can be reverse-engineered to extract domains</li></ul></li><li>Domain Generation Algorithms (DGA)<ul><li>Generate domain names depending on one or more external information sources serving predictable seed values that can be accessed by bots and botmasters.</li><li>Seed values: timestamp, Twitter trends</li></ul></li></ul></li><li><p>Detection</p><ul><li>Passive techniques</li><li>Active techniques<ul><li>Sinkholing: Redirecting or dropping traffic destined to a C&amp;C server, malware distribution server or attack server.</li></ul></li><li>Reverse engineering of bots</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="92-ddos-attacks"></a>9.2 DDos attacks<a aria-hidden="true" tabindex="-1" class="hash-link" href="#92-ddos-attacks" title="Direct link to heading">#</a></h3><ul><li>DDos can:<ul><li>Degrades a resource used by a victim (legitimate user) or</li><li>Denies use of a resource by a victim</li><li>Clog/crash a resource</li></ul></li><li>Target resources:<ul><li>network bandwidth, </li><li>CPU, </li><li>database/disk bandwidth</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="93-ddos-attack-methods"></a>9.3 DDos Attack methods<a aria-hidden="true" tabindex="-1" class="hash-link" href="#93-ddos-attack-methods" title="Direct link to heading">#</a></h3><ul><li><p>SYN floods</p><ul><li>When TCP establishs a connection, it would handshake first:<ul><li>TCP three-way handshake: SYN, SYN-ACK, ACK</li><li>Half-open connections: SYN, SYN-ACK</li></ul></li><li>Weak point<ul><li>Each SYN packet (new connection) mandates the server to allocate resources</li></ul></li><li>Attack<ul><li>Attack on the <strong><em>memory</em></strong></li><li><strong><em>Fake/genuine</em></strong> IP addresses can be used to sent tons of SYN packets</li></ul></li></ul></li><li><p>Application-based attacks</p><ul><li>HTTP flood<ul><li>Generally launched from a botnet (need <strong><em>genuine</em></strong> IP, because have to establish the connection first)</li><li>Attack<ul><li>Attack on the <strong><em>bandwidth</em></strong> and CPU</li><li>Large files requests</li><li>Search service of a site</li><li>Complex queries</li></ul></li></ul></li></ul></li><li><p>DNS amplification attack</p><ul><li><p>How it works</p><ol><li><p>Compromise an authoritative DNS server and publish a large TXT record</p><ul><li><p>TXT record: a type of resource record in the Domain Name System (DNS) used to provide the ability to associate arbitrary text with a host or other name, such as human readable information about a server, network, data center, or other accounting information.</p><p>  <code>example.com   IN   TXT   &quot;This domain name is reserved for use in documentation&quot;</code></p></li></ul></li><li><p>The attacker uses botnet to send UDP packets with <em>spoofed</em> IP addresses to a DNS recursor. The spoofed address on the packets points to the real IP address of the victim.</p></li><li><p>Each one of the UDP packets makes a request to a DNS resolver, often passing an argument such as “ANY” in order to receive the largest response possible.</p></li><li><p>After receiving the requests, the DNS resolver, which is trying to be helpful by responding, sends a large response to the spoofed IP address.</p></li><li><p>The IP address of the target receives the response and the surrounding network infrastructure becomes overwhelmed with the deluge of traffic, resulting in a denial-of-service.</p></li></ol></li><li><p>Difficult to prevent</p><ul><li>Millions of open recursive DNS servers</li><li>High capacity servers (&quot;fat&quot; bandwidth)</li><li>DNS servers are not directly affected – no incentive to adopt known &quot;good practices&quot;</li><li>may not need to compromise an authoritative DNS server</li></ul></li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="94-mirai-attack"></a>9.4 Mirai attack<a aria-hidden="true" tabindex="-1" class="hash-link" href="#94-mirai-attack" title="Direct link to heading">#</a></h3><p>![Mirai]({{ site.baseurl }}/assets/resources/SOEN321/Mirai.png)</p><ol><li>Scan: sent TCP CYN probes to pseudorandom IPv4 addresses, excluding blacklist. <ul><li>Why scan? and scan efficient?<ul><li>Stateless: no memeory allocation. But if recevied any response from any device, that device is a potential victim.</li></ul></li></ul></li><li>If a potential victim is found, starts a brute-force login phase.<ul><li>Use preconfigured dictionary, because resource is constrained.</li></ul></li><li>Send the victim&#x27;s IP and associated credentials to Report Server.</li><li>Report Server dispatches the command to Loader.</li><li>Loader will try to login the victim devicem then try to find out what kind of this device is.</li><li>Loader will send corresponding binary to the victim, and the victime would join the botnet.</li><li>Finally, the attacker would use the botnet to launch other attacks.</li></ol><hr><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="13-domain-fronting"></a>13. Domain Fronting<a aria-hidden="true" tabindex="-1" class="hash-link" href="#13-domain-fronting" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="what"></a>What<a aria-hidden="true" tabindex="-1" class="hash-link" href="#what" title="Direct link to heading">#</a></h3><ul><li>Circumvents Internet <em>censorship</em> by obfuscating the domain of a HTTPS connection</li><li>Allows a user to connect to a blocked service (via DNS, IP or deep packet inspection)</li><li>uses different domain names at different layers of communication</li><li>In an HTTPS request, the destination domain name appears in<ul><li>the DNS query,</li><li>the TLS Server Name Indication (SNI) extension,</li><li>and the HTTP Host header</li></ul></li><li>For<ul><li>regular connections, the same domain name is used.</li><li>domain-fonted connections, HTTP Host has the true destination domain.</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="techniques"></a>Techniques<a aria-hidden="true" tabindex="-1" class="hash-link" href="#techniques" title="Direct link to heading">#</a></h3><ol><li>With a front domain name: </li><li>Domainless fronting</li></ol><hr><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="14-write-protection-against-privileged-data-tampering"></a>14. Write Protection Against Privileged Data Tampering<a aria-hidden="true" tabindex="-1" class="hash-link" href="#14-write-protection-against-privileged-data-tampering" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="141-legacy-solutions"></a>14.1 Legacy solutions<a aria-hidden="true" tabindex="-1" class="hash-link" href="#141-legacy-solutions" title="Direct link to heading">#</a></h3><ol><li>detection via anti-malware</li><li>key recovery via reverse engineering</li><li>backup</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="142-academic-proposals"></a>14.2 Academic proposals<a aria-hidden="true" tabindex="-1" class="hash-link" href="#142-academic-proposals" title="Direct link to heading">#</a></h3><ol><li>monitoring file I/O activities</li><li>recording encryption keys</li><li>shadowing file writes</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="143-flashguard"></a>14.3 FlashGuard<a aria-hidden="true" tabindex="-1" class="hash-link" href="#143-flashguard" title="Direct link to heading">#</a></h3><ul><li>relies on intrinsic properties of SSD writes</li><li>cannot deal with data destruction malware</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="144-data-loss-prevention"></a>14.4 Data loss prevention<a aria-hidden="true" tabindex="-1" class="hash-link" href="#144-data-loss-prevention" title="Direct link to heading">#</a></h3><ul><li>Trusted environments<ul><li>TEE-Disk: Self-encrypting devices<ol><li>Fine-granined access control</li><li>programmable control (lock-unlock)</li></ol></li><li>TEE-Host: Intel TXT or AMD SVM<ol><li>Dynamic root of trust, measured, isolated</li><li>Sealed secret (platform state binding)</li><li>Device I/O access</li></ol></li></ul></li><li>Design<ul><li>Stand-alone: occasional interruptions due to TXT exclusiveness</li><li>Network-based: any user device, no interruptions</li></ul></li><li>Space cleanup<ul><li>Automatic stale version deletion</li><li>Mini file browser: manual file deletion (within the trusted updater)</li></ul></li><li>Challenges<ol><li>Safely use I/O devices from the user OS</li><li>Programming the SED OPAL interface</li><li>DMA access in TEE</li><li>Porting Flicker to Windows 10 64-bit</li><li>Security<ol><li>Outside the trusted environment, can malware update files on the protected partition?</li><li>Inside the trusted environment, can malware trick the updater to write arbitrary content?</li></ol></li></ol></li><li>Attacks to consider<ul><li>Forged UI</li><li>Termination</li><li>Flaws in TEE implementations</li><li>Persistent attacker (delayed attacks after deletion)</li></ul></li></ul><hr><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="tutorial-9---rsaaes-encryption-with-openssl"></a>Tutorial 9 - RSA/AES encryption with OpenSSL<a aria-hidden="true" tabindex="-1" class="hash-link" href="#tutorial-9---rsaaes-encryption-with-openssl" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="public-key-crypto"></a>Public key crypto<a aria-hidden="true" tabindex="-1" class="hash-link" href="#public-key-crypto" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="release-your-public-key"></a>Release your public key<a aria-hidden="true" tabindex="-1" class="hash-link" href="#release-your-public-key" title="Direct link to heading">#</a></h4><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="usage"></a>Usage:<a aria-hidden="true" tabindex="-1" class="hash-link" href="#usage" title="Direct link to heading">#</a></h4><ul><li>Encryption</li></ul><ol><li>Anyone encrypts using your <em>public</em> key</li><li>Nobody can decrpty but you with your <em>private</em> key</li></ol><ul><li>Signature</li></ul><ol><li>You sign some data with your <em>private</em> key</li><li>Anyone can verify your signature with your <em>public</em> key</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="rsa-encryptiondecryption-with-openssl"></a>RSA encryption/decryption with OpenSSL<a aria-hidden="true" tabindex="-1" class="hash-link" href="#rsa-encryptiondecryption-with-openssl" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="generate-key"></a>Generate key<a aria-hidden="true" tabindex="-1" class="hash-link" href="#generate-key" title="Direct link to heading">#</a></h4><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">openssl genrsa -aes256 -out alice.key </span><span class="token number" style="color:rgb(247, 140, 108)">2048</span></div></div></div></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="steps"></a>Steps<a aria-hidden="true" tabindex="-1" class="hash-link" href="#steps" title="Direct link to heading">#</a></h4><ol><li>Extract the public key</li></ol><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">openssl rsa -in alice.key -pubout -out alice.pub</span></div></div></div></div></div><ol start="2"><li>(Optional) look at Alice&#x27;s public key</li></ol><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">openssl rsa -in alice.pub -pubin -noout -text</span></div></div></div></div></div><ol start="2"><li>Pass the public key to Bob</li><li>Bob encrypt the message with Alice&#x27;s public key</li></ol><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">openssl rsautl -encrypt -inkey alice.pub -pubin -in secret.txt -out secret.txt.enc</span></div></div></div></div></div><ol start="4"><li>Bob pass the encrypted message to Alice</li><li>Alice decrypt the message with her private key</li></ol><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">openssl rsautl -decrypt -inkey alice.key -in secret.txt.enc -out secret.txt.dec</span></div></div></div></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="problem"></a>Problem<a aria-hidden="true" tabindex="-1" class="hash-link" href="#problem" title="Direct link to heading">#</a></h4><ol><li>Computation expensive</li><li>Plaintext&#x27;s size should be smaller than the modulus (2048)</li></ol><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="solution"></a>Solution<a aria-hidden="true" tabindex="-1" class="hash-link" href="#solution" title="Direct link to heading">#</a></h4><ul><li>Hybrid encryption: Asymmetric and symmetric encryption</li><li>RSA encrypt a symmetric key to encrypt secret</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="aes-encryptiondecryption-with-openssl"></a>AES encryption/decryption with OpenSSL<a aria-hidden="true" tabindex="-1" class="hash-link" href="#aes-encryptiondecryption-with-openssl" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="steps-1"></a>Steps<a aria-hidden="true" tabindex="-1" class="hash-link" href="#steps-1" title="Direct link to heading">#</a></h4><ol><li>Bob generates a random AES key and IV:</li></ol><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">openssl rand -hex -out aes.key </span><span class="token number" style="color:rgb(247, 140, 108)">32</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">openssl rand -hex -out aes.iv </span><span class="token number" style="color:rgb(247, 140, 108)">16</span></div></div></div></div></div><ul><li><code>32</code>$=256$ bits (key size for AES-256)</li><li><code>16</code>$=128$ bits (block size for AES-256)</li></ul><ol start="2"><li>Bob encrypts the message with his own AES key and IV</li></ol><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">openssl enc -aes-256-cbc -in secret.txt -out secret.txt.enc -K %key% -iv %iv% -p</span></div></div></div></div></div><ol start="3"><li>Bob encrypts the AES key and IV with Alice&#x27;s public key</li></ol><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">openssl rsautl -encrypt -inkey alice.pub -pubin -in aes.key -out aes.key.enc</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">openssl rsautl -encrypt -inkey alice.pub -pubin -in aes.iv -out aes.iv.enc</span></div></div></div></div></div><ol start="4"><li>Bob send <code>aes.key.enc, aes.iv.enc, secret.txt.enc</code> to Alice</li><li>Alice decrypts the AES key and IV</li></ol><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">openssl rsautl -decrypt -inkey alice.key -in aes.key.enc -out aes.key.dec</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">openssl rsautl -decrypt -inkey alice.key -in aes.iv.enc -out aes.iv.dec</span></div></div></div></div></div><ol start="6"><li>Alice decrypts the encrypted message</li></ol><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">openssl enc -d -aes-256-cbc -in secret.txt.enc -out secret.txt.dec -K</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">%key% -iv %iv%</span></div></div></div></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="alternative-steps"></a>Alternative Steps<a aria-hidden="true" tabindex="-1" class="hash-link" href="#alternative-steps" title="Direct link to heading">#</a></h4><ul><li>Use PBKDF2 to simplify key and IV generation</li></ul><ol><li>Bob eenerate a password randomly</li></ol><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">openssl rand -hex -out pass.key </span><span class="token number" style="color:rgb(247, 140, 108)">32</span></div></div></div></div></div><ol start="2"><li>Bob encrypts using a file as password</li></ol><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">openssl enc -aes-256-cbc -in secret.txt -out secret.txt.enc -pass file:pass.key -pbkdf2 -iter </span><span class="token number" style="color:rgb(247, 140, 108)">100000</span><span class="token plain"> -md sha256</span></div></div></div></div></div><ol start="3"><li>Bob encrypts the password file with Alice&#x27;s public key</li></ol><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">openssl rsautl -encrypt -inkey alice.pub -pubin -in pass.key -out pass.key.enc</span></div></div></div></div></div><ol start="4"><li>Bob send <code>pass.key.enc, secret.txt.enc</code> to Alice</li><li>Alice decrypts the password file</li></ol><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">openssl rsautl -decrypt -inkey alice.key -in pass.key.enc -out pass.key.dec</span></div></div></div></div></div><ol start="6"><li>Alice decrypts the secret using the password file</li></ol><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">openssl enc -d -aes-256-cbc -in secret.txt.enc -out secret.txt.dec -pass</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">file:pass.key.dec -pbkdf2 -iter </span><span class="token number" style="color:rgb(247, 140, 108)">100000</span><span class="token plain"> -md sha256</span></div></div></div></div></div></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/facebook/docusaurus/edit/master/website/docs/course/SOEN321.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/course/doc3"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« This is Document Number 3</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/course/SOEN321_Project"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">SOEN 321 Project »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_TbNY"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#outline" class="table-of-contents__link">Outline</a><ul><li><a href="#final" class="table-of-contents__link">Final</a></li><li><a href="#cheatsheet" class="table-of-contents__link">Cheatsheet</a></li></ul></li><li><a href="#0-preparation" class="table-of-contents__link">0. Preparation</a><ul><li><a href="#01-modulus" class="table-of-contents__link">0.1 Modulus</a></li><li><a href="#02-pseudo-random-number-generators-prng" class="table-of-contents__link">0.2 Pseudo-Random Number Generators (PRNG)</a></li><li><a href="#03-some-other-types-of-security" class="table-of-contents__link">0.3 Some Other Types of Security</a></li><li><a href="#04-attack-analysis" class="table-of-contents__link">0.4 Attack analysis</a></li></ul></li><li><a href="#1-trusting-trust" class="table-of-contents__link">1. Trusting trust</a><ul><li><a href="#11-security-stack" class="table-of-contents__link">1.1 Security stack</a></li><li><a href="#12-security-vs-correctness" class="table-of-contents__link">1.2 Security v.s. Correctness</a></li><li><a href="#13-what-code-to-trust" class="table-of-contents__link">1.3 What code to trust?</a></li><li><a href="#14-examples" class="table-of-contents__link">1.4 Examples</a></li><li><a href="#15-security-mindset" class="table-of-contents__link">1.5 Security Mindset</a></li></ul></li><li><a href="#2-cryptography" class="table-of-contents__link">2. Cryptography</a><ul><li><a href="#21-what-cryptography-is" class="table-of-contents__link">2.1 What Cryptography is</a></li><li><a href="#22-what-cryptography-for" class="table-of-contents__link">2.2 What Cryptography for</a></li><li><a href="#23-cryptology" class="table-of-contents__link">2.3 Cryptology</a></li><li><a href="#24-basic-tools-of-cryptography-security-primitives" class="table-of-contents__link">2.4 Basic tools of cryptography: Security Primitives</a></li><li><a href="#25-attacker-model" class="table-of-contents__link">2.5 Attacker model</a></li><li><a href="#26-encryption" class="table-of-contents__link">2.6 Encryption</a></li><li><a href="#27-examples" class="table-of-contents__link">2.7 Examples</a></li><li><a href="#28-how-to-attack-encryption" class="table-of-contents__link">2.8 How to attack encryption</a></li></ul></li><li><a href="#3-stream-ciphers" class="table-of-contents__link">3. Stream ciphers</a><ul><li><a href="#31-vernam-cipher" class="table-of-contents__link">3.1 Vernam Cipher</a></li><li><a href="#32-one-time-pad" class="table-of-contents__link">3.2 One-time pad</a></li><li><a href="#33-rc4" class="table-of-contents__link">3.3 RC4</a></li><li><a href="#34-chacha20-stream-cipher" class="table-of-contents__link">3.4 ChaCha20 stream cipher</a></li></ul></li><li><a href="#4-block-ciphers-symmetric-key" class="table-of-contents__link">4. Block ciphers (symmetric key)</a><ul><li><a href="#41-electronic-codebook-ecb" class="table-of-contents__link">4.1 Electronic Codebook (ECB)</a></li><li><a href="#42-cipher-block-chaining-cbc" class="table-of-contents__link">4.2 Cipher Block Chaining (CBC)</a></li><li><a href="#43-counter-mode-ctr" class="table-of-contents__link">4.3 Counter mode (CTR)</a></li><li><a href="#44-xts-aes" class="table-of-contents__link">4.4 XTS-AES</a></li><li><a href="#45-ecb-cts" class="table-of-contents__link">4.5 ECB-CTS</a></li><li><a href="#46-block-cipher-design-components" class="table-of-contents__link">4.6 Block cipher: design components</a></li><li><a href="#47-data-encryption-standard-des" class="table-of-contents__link">4.7 Data Encryption Standard (DES)</a></li><li><a href="#48-advanced-encryptioin-standard-aes" class="table-of-contents__link">4.8 Advanced Encryptioin Standard (AES)</a></li></ul></li><li><a href="#5-hash-functions" class="table-of-contents__link">5. Hash Functions</a><ul><li><a href="#51-what-it-is" class="table-of-contents__link">5.1 What it is</a></li><li><a href="#52-classification" class="table-of-contents__link">5.2 Classification</a></li><li><a href="#53-how-to-build-a-hash-function" class="table-of-contents__link">5.3 How to build a hash function</a></li><li><a href="#54-general-structure-of-iterated-hash-functions" class="table-of-contents__link">5.4 General structure of iterated Hash Functions</a></li><li><a href="#55-hash-functions-based-on-block-ciphers" class="table-of-contents__link">5.5 Hash functions based on block ciphers</a></li><li><a href="#56-applications" class="table-of-contents__link">5.6 Applications</a></li><li><a href="#57-pre-computation-attacks-rainbow-table-hash-chain-attacks" class="table-of-contents__link">5.7 Pre-computation attacks (Rainbow-table hash-chain attacks)</a></li></ul></li><li><a href="#6-message-authentication-code-mac" class="table-of-contents__link">6. Message Authentication Code (MAC)</a><ul><li><a href="#61-what-it-is" class="table-of-contents__link">6.1 What it is</a></li><li><a href="#62-mdc-vs-mac" class="table-of-contents__link">6.2 MDC vs MAC</a></li><li><a href="#63-hash-based-mac" class="table-of-contents__link">6.3 Hash-based MAC</a></li><li><a href="#64-mac-from-block-ciphers-cbc-mac" class="table-of-contents__link">6.4 MAC from block ciphers: CBC MAC</a></li><li><a href="#65-password-based-key-derivation-function-pbkdf2" class="table-of-contents__link">6.5 Password-Based Key Derivation Function (PBKDF2)</a></li></ul></li><li><a href="#7-public-key-cryptography-and-ssl" class="table-of-contents__link">7. Public Key Cryptography and SSL</a><ul><li><a href="#71-overview" class="table-of-contents__link">7.1 Overview</a></li><li><a href="#72-public-key-cryptography" class="table-of-contents__link">7.2 Public Key Cryptography</a></li><li><a href="#73-public-key-encryption" class="table-of-contents__link">7.3 Public Key Encryption</a></li><li><a href="#74-public-key-signatures" class="table-of-contents__link">7.4 Public Key Signatures</a></li><li><a href="#75-diffie-hellman-key-exchange-d-h-key-exchange" class="table-of-contents__link">7.5 Diffie-Hellman Key Exchange (D-H Key Exchange)</a></li><li><a href="#76-password-authenticated-key-exchange" class="table-of-contents__link">7.6 Password Authenticated Key Exchange</a></li><li><a href="#77-rsa" class="table-of-contents__link">7.7 RSA</a></li><li><a href="#78-rsa-encryption" class="table-of-contents__link">7.8 RSA Encryption</a></li><li><a href="#79-digital-signature" class="table-of-contents__link">7.9 Digital Signature</a></li><li><a href="#710-rsa-signature" class="table-of-contents__link">7.10 RSA Signature</a></li><li><a href="#711-ssl" class="table-of-contents__link">7.11 SSL</a></li></ul></li><li><a href="#8--usability-and-human-factors-in-security" class="table-of-contents__link">8.  Usability and human factors in security</a><ul><li><a href="#81-pretty-good-privacy-pgp" class="table-of-contents__link">8.1 Pretty Good Privacy (PGP)</a></li><li><a href="#82-human-as-an-attack-vector" class="table-of-contents__link">8.2 Human as an attack vector</a></li><li><a href="#83-phishing" class="table-of-contents__link">8.3 Phishing</a></li><li><a href="#84-the-rsa-secureid-hack-hardware-authentication-token" class="table-of-contents__link">8.4 The RSA SecureId Hack (Hardware authentication token)</a></li><li><a href="#85-deception" class="table-of-contents__link">8.5 Deception</a></li></ul></li><li><a href="#9-botnets-and-ddos" class="table-of-contents__link">9. Botnets and DDoS</a><ul><li><a href="#91-botnets" class="table-of-contents__link">9.1 Botnets</a></li><li><a href="#92-ddos-attacks" class="table-of-contents__link">9.2 DDos attacks</a></li><li><a href="#93-ddos-attack-methods" class="table-of-contents__link">9.3 DDos Attack methods</a></li><li><a href="#94-mirai-attack" class="table-of-contents__link">9.4 Mirai attack</a></li></ul></li><li><a href="#13-domain-fronting" class="table-of-contents__link">13. Domain Fronting</a><ul><li><a href="#what" class="table-of-contents__link">What</a></li><li><a href="#techniques" class="table-of-contents__link">Techniques</a></li></ul></li><li><a href="#14-write-protection-against-privileged-data-tampering" class="table-of-contents__link">14. Write Protection Against Privileged Data Tampering</a><ul><li><a href="#141-legacy-solutions" class="table-of-contents__link">14.1 Legacy solutions</a></li><li><a href="#142-academic-proposals" class="table-of-contents__link">14.2 Academic proposals</a></li><li><a href="#143-flashguard" class="table-of-contents__link">14.3 FlashGuard</a></li><li><a href="#144-data-loss-prevention" class="table-of-contents__link">14.4 Data loss prevention</a></li></ul></li><li><a href="#tutorial-9---rsaaes-encryption-with-openssl" class="table-of-contents__link">Tutorial 9 - RSA/AES encryption with OpenSSL</a><ul><li><a href="#public-key-crypto" class="table-of-contents__link">Public key crypto</a></li><li><a href="#rsa-encryptiondecryption-with-openssl" class="table-of-contents__link">RSA encryption/decryption with OpenSSL</a></li><li><a href="#aes-encryptiondecryption-with-openssl" class="table-of-contents__link">AES encryption/decryption with OpenSSL</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="text--center"><div>Copyright © 2020 Ling. Built with Docusaurus.</div></div></div></footer></div>
<script src="/styles.5110f610.js"></script>
<script src="/runtime~main.411159be.js"></script>
<script src="/main.5092485a.js"></script>
<script src="/1.342f0786.js"></script>
<script src="/2.e69fd93d.js"></script>
<script src="/3.31f2c4b8.js"></script>
<script src="/1be78505.636d6477.js"></script>
<script src="/47.c1ae8faa.js"></script>
<script src="/20ac7829.3d0e1285.js"></script>
<script src="/17896441.78a6df2d.js"></script>
<script src="/a3e49c46.d2ab06bb.js"></script>
</body>
</html>